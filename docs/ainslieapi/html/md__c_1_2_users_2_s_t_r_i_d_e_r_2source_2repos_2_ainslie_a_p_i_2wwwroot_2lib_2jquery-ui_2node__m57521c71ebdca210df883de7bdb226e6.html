<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AinslieAPI: is-my-json-valid</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">AinslieAPI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__c_1_2_users_2_s_t_r_i_d_e_r_2source_2repos_2_ainslie_a_p_i_2wwwroot_2lib_2jquery-ui_2node__m57521c71ebdca210df883de7bdb226e6.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">is-my-json-valid</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md2963"></a> A <a href="https://json-schema.org/">JSONSchema</a> validator that uses code generation to be extremely fast.</p>
<p>It passes the entire JSONSchema v4 test suite except for <code>remoteRefs</code> and <code>maxLength</code>/<code>minLength</code> when using unicode surrogate pairs.</p>
<p><a href="https://travis-ci.org/mafintosh/is-my-json-valid"><img src="https://img.shields.io/travis/mafintosh/is-my-json-valid.svg?style=flat" alt="build status" style="pointer-events: none;" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md2964"></a>
Installation</h1>
<div class="fragment"><div class="line">npm install --save is-my-json-valid</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2965"></a>
Usage</h1>
<p>Simply pass a schema to compile it</p>
<div class="fragment"><div class="line">var validator = require(&#39;is-my-json-valid&#39;)</div>
<div class="line"> </div>
<div class="line">var validate = validator({</div>
<div class="line">  required: true,</div>
<div class="line">  type: &#39;object&#39;,</div>
<div class="line">  properties: {</div>
<div class="line">    hello: {</div>
<div class="line">      required: true,</div>
<div class="line">      type: &#39;string&#39;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">console.log(&#39;should be valid&#39;, validate({hello: &#39;world&#39;}))</div>
<div class="line">console.log(&#39;should not be valid&#39;, validate({}))</div>
<div class="line"> </div>
<div class="line">// get the last list of errors by checking validate.errors</div>
<div class="line">// the following will print [{field: &#39;data.hello&#39;, message: &#39;is required&#39;}]</div>
<div class="line">console.log(validate.errors)</div>
</div><!-- fragment --><p>You can also pass the schema as a string</p>
<div class="fragment"><div class="line">var validate = validator(&#39;{&quot;type&quot;: ... }&#39;)</div>
</div><!-- fragment --><p>Optionally you can use the require submodule to load a schema from <code>__dirname</code></p>
<div class="fragment"><div class="line">var validator = require(&#39;is-my-json-valid/require&#39;)</div>
<div class="line">var validate = validator(&#39;my-schema.json&#39;)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2966"></a>
Custom formats</h1>
<p>is-my-json-valid supports the formats specified in JSON schema v4 (such as date-time). If you want to add your own custom formats pass them as the formats options to the validator</p>
<div class="fragment"><div class="line">var validate = validator({</div>
<div class="line">  type: &#39;string&#39;,</div>
<div class="line">  required: true,</div>
<div class="line">  format: &#39;only-a&#39;</div>
<div class="line">}, {</div>
<div class="line">  formats: {</div>
<div class="line">    &#39;only-a&#39;: /^a+$/</div>
<div class="line">  }</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">console.log(validate(&#39;aa&#39;)) // true</div>
<div class="line">console.log(validate(&#39;ab&#39;)) // false</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2967"></a>
External schemas</h1>
<p>You can pass in external schemas that you reference using the <code>$ref</code> attribute as the <code>schemas</code> option</p>
<div class="fragment"><div class="line">var ext = {</div>
<div class="line">  required: true,</div>
<div class="line">  type: &#39;string&#39;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">var schema = {</div>
<div class="line">  $ref: &#39;#ext&#39; // references another schema called ext</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">// pass the external schemas as an option</div>
<div class="line">var validate = validator(schema, {schemas: {ext: ext}})</div>
<div class="line"> </div>
<div class="line">validate(&#39;hello&#39;) // returns true</div>
<div class="line">validate(42) // return false</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2968"></a>
Filtering away additional properties</h1>
<p>is-my-json-valid supports filtering away properties not in the schema</p>
<div class="fragment"><div class="line">var filter = validator.filter({</div>
<div class="line">  required: true,</div>
<div class="line">  type: &#39;object&#39;,</div>
<div class="line">  properties: {</div>
<div class="line">    hello: {type: &#39;string&#39;, required: true}</div>
<div class="line">  },</div>
<div class="line">  additionalProperties: false</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">var doc = {hello: &#39;world&#39;, notInSchema: true}</div>
<div class="line">console.log(filter(doc)) // {hello: &#39;world&#39;}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2969"></a>
Verbose mode shows more information about the source of the error</h1>
<p>When the <code>verbose</code> options is set to <code>true</code>, <code>is-my-json-valid</code> also outputs:</p>
<ul>
<li><code>value</code>: The data value that caused the error</li>
<li><code>schemaPath</code>: an array of keys indicating which sub-schema failed</li>
</ul>
<div class="fragment"><div class="line">var schema = {</div>
<div class="line">  required: true,</div>
<div class="line">  type: &#39;object&#39;,</div>
<div class="line">  properties: {</div>
<div class="line">    hello: {</div>
<div class="line">      required: true,</div>
<div class="line">      type: &#39;string&#39;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line">var validate = validator(schema, {</div>
<div class="line">  verbose: true</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">validate({hello: 100});</div>
<div class="line">console.log(validate.errors)</div>
<div class="line">// [ { field: &#39;data.hello&#39;,</div>
<div class="line">//     message: &#39;is the wrong type&#39;,</div>
<div class="line">//     value: 100,</div>
<div class="line">//     type: &#39;string&#39;,</div>
<div class="line">//     schemaPath: [ &#39;properties&#39;, &#39;hello&#39; ] } ]</div>
</div><!-- fragment --><p>Many popular libraries make it easy to retrieve the failing rule with the <code>schemaPath</code>:</p>
<div class="fragment"><div class="line">var schemaPath = validate.errors[0].schemaPath</div>
<div class="line">var R = require(&#39;ramda&#39;)</div>
<div class="line"> </div>
<div class="line">console.log( &#39;All evaluate to the same thing: &#39;, R.equals(</div>
<div class="line">  schema.properties.hello,</div>
<div class="line">  { required: true, type: &#39;string&#39; },</div>
<div class="line">  R.path(schemaPath, schema),</div>
<div class="line">  require(&#39;lodash&#39;).get(schema, schemaPath),</div>
<div class="line">  require(&#39;jsonpointer&#39;).get(schema, [&quot;&quot;].concat(schemaPath))</div>
<div class="line">))</div>
<div class="line">// All evaluate to the same thing: true</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2970"></a>
Greedy mode tries to validate as much as possible</h1>
<p>By default is-my-json-valid bails on first validation error but when greedy is set to true it tries to validate as much as possible:</p>
<div class="fragment"><div class="line">var validate = validator({</div>
<div class="line">  type: &#39;object&#39;,</div>
<div class="line">  properties: {</div>
<div class="line">    x: {</div>
<div class="line">      type: &#39;number&#39;</div>
<div class="line">    }</div>
<div class="line">  },</div>
<div class="line">  required: [&#39;x&#39;, &#39;y&#39;]</div>
<div class="line">}, {</div>
<div class="line">  greedy: true</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">validate({x: &#39;string&#39;});</div>
<div class="line">console.log(validate.errors) // [{field: &#39;data.y&#39;, message: &#39;is required&#39;},</div>
<div class="line">                             //  {field: &#39;data.x&#39;, message: &#39;is the wrong type&#39;}]</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2971"></a>
Error messages</h1>
<p>Here is a list of possible <code>message</code> values for errors:</p>
<ul>
<li><code>is required</code></li>
<li><code>is the wrong type</code></li>
<li><code>has additional items</code></li>
<li><code>must be FORMAT format</code> (FORMAT is the <code>format</code> property from the schema)</li>
<li><code>must be unique</code></li>
<li><code>must be an enum value</code></li>
<li><code>dependencies not set</code></li>
<li><code>has additional properties</code></li>
<li><code>referenced schema does not match</code></li>
<li><code>negative schema matches</code></li>
<li><code>pattern mismatch</code></li>
<li><code>no schemas match</code></li>
<li><code>no (or more than one) schemas match</code></li>
<li><code>has a remainder</code></li>
<li><code>has more properties than allowed</code></li>
<li><code>has less properties than allowed</code></li>
<li><code>has more items than allowed</code></li>
<li><code>has less items than allowed</code></li>
<li><code>has longer length than allowed</code></li>
<li><code>has less length than allowed</code></li>
<li><code>is less than minimum</code></li>
<li><code>is more than maximum</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md2972"></a>
Performance</h1>
<p>is-my-json-valid uses code generation to turn your JSON schema into basic javascript code that is easily optimizeable by v8.</p>
<p>At the time of writing, is-my-json-valid is the <b>fastest validator</b> when running</p>
<ul>
<li><a href="https://github.com/Muscula/json-schema-benchmark">json-schema-benchmark</a></li>
<li><a href="http://cosmicrealms.com/blog/2014/08/29/benchmark-of-node-dot-js-json-validation-modules-part-3/">cosmicreals.com benchmark</a></li>
<li><a href="https://github.com/pandastrike/jsck/issues/72#issuecomment-70992684">jsck benchmark</a></li>
<li><a href="https://cdn.rawgit.com/playlyfe/themis/master/benchmark/results.html">themis benchmark</a></li>
<li><a href="https://rawgit.com/zaggino/z-schema/master/benchmark/results.html">z-schema benchmark</a></li>
</ul>
<p>If you know any other relevant benchmarks open a PR and I'll add them.</p>
<h1><a class="anchor" id="autotoc_md2973"></a>
TypeScript support</h1>
<p>This library ships with TypeScript typings. They are still early on and not perfect at the moment, but should hopefully handle the most common cases. If you find anything that doesn't work, please open an issue and we'll try to solve it.</p>
<p>The typings are using <code>unknown</code> and thus require TypeScript 3.0 or later.</p>
<p>Here is a quick sample of usage together with express:</p>
<div class="fragment"><div class="line">import createError = require(&#39;http-errors&#39;)</div>
<div class="line">import createValidator = require(&#39;is-my-json-valid&#39;)</div>
<div class="line">import { Request, Response, NextFunction } from &#39;express&#39;</div>
<div class="line"> </div>
<div class="line">const personValidator = createValidator({</div>
<div class="line">  type: &#39;object&#39;,</div>
<div class="line">  properties: {</div>
<div class="line">    name: { type: &#39;string&#39; },</div>
<div class="line">    age: { type: &#39;number&#39; },</div>
<div class="line">  },</div>
<div class="line">  required: [</div>
<div class="line">    &#39;name&#39;</div>
<div class="line">  ]</div>
<div class="line">})</div>
<div class="line"> </div>
<div class="line">export function post (req: Request, res: Response, next: NextFunction) {</div>
<div class="line">  // Here req.body is typed as: any</div>
<div class="line"> </div>
<div class="line">  if (!personValidator(req.body)) {</div>
<div class="line">    throw createError(400, { errors: personValidator.errors })</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  // Here req.body is typed as: { name: string, age: number | undefined }</div>
<div class="line">}</div>
</div><!-- fragment --><p>As you can see, the typings for is-my-json-valid will contruct an interface from the schema passed in. This allows you to work with your incoming json body in a type safe way.</p>
<h1><a class="anchor" id="autotoc_md2974"></a>
License</h1>
<p>MIT </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
