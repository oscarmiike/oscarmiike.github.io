\doxysection{Spot\+Helper.\+cs}
\hypertarget{_spot_helper_8cs_source}{}\label{_spot_helper_8cs_source}\index{C:/Users/STRIDER/source/repos/TaskAPI/Helpers/SpotHelper.cs@{C:/Users/STRIDER/source/repos/TaskAPI/Helpers/SpotHelper.cs}}
\mbox{\hyperlink{_spot_helper_8cs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00001}00001\ \textcolor{keyword}{using\ }Microsoft.Extensions.Options;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00002}00002\ \textcolor{keyword}{using\ }Microsoft.Identity.Client;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00003}00003\ \textcolor{keyword}{using\ }System;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00004}00004\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_helpers_1_1_settings}{TaskAPI.Helpers.Settings}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00005}00005\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_models}{TaskAPI.Models}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00006}00006\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_models_1_1_d_t_o_1_1_polygon_oracle}{TaskAPI.Models.DTO.PolygonOracle}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00007}00007\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_services}{TaskAPI.Services}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00008}00008\ \textcolor{keyword}{using\ }RestSharp;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00009}00009\ \textcolor{keyword}{using\ }Newtonsoft.Json;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00010}00010\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_models_1_1_d_t_o}{TaskAPI.Models.DTO}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00011}00011\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i}{TaskAPI.Models.DTO.InternalAPI}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00012}00012\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_models_1_1_d_t_o_1_1_oanda}{TaskAPI.Models.DTO.Oanda}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00013}00013\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_contexts}{TaskAPI.Contexts}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00014}00014\ \textcolor{keyword}{using\ }Microsoft.EntityFrameworkCore;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00015}00015\ \textcolor{keyword}{using\ }System.IO;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00016}00016\ \textcolor{keyword}{using\ }Nethereum.Contracts.QueryHandlers.MultiCall;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00017}00017\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00018}00018\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_helpers}{TaskAPI.Helpers}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00019}00019\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00020}\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper}{00020}}\ \textcolor{keyword}{public}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper}{SpotHelper}}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00021}00021\ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00022}00022\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}\ \_logService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00023}00023\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_forex_service}{ForexService}}\ \_forexService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00024}00024\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_alchemy_service}{AlchemyService}}\ \_alchemyService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00025}00025\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_binance_service}{BinanceService}}\ \_binanceService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00026}00026\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings}{TaskAPISettings}}\ \_settings;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00027}00027\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_task_a_p_i_1_1_contexts_1_1_priceapp_context}{PriceappContext}}\ \_context;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00028}00028\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_internal_a_p_i_service}{InternalAPIService}}\ \_iapiService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00029}00029\ \ \ \ \ \textcolor{keyword}{private}\ IWebHostEnvironment\ \_env;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00030}00030\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{bool}\ marketOpen;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00031}00031\ \ \ \ \ \textcolor{keyword}{private}\ MarketStatusOverrides\ marketStatusOverride;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00032}00032\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00033}00033\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{double}\ tOzGrams\ =\ 31.1035;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00034}00034\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00035}00035\ \ \ \ \ \textcolor{keyword}{enum}\ MarketStatusOverrides}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00036}00036\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00037}00037\ \ \ \ \ \ \ \ \ ForceClosed\ =\ 0,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00038}00038\ \ \ \ \ \ \ \ \ UseMarket\ =\ 1,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00039}00039\ \ \ \ \ \ \ \ \ ForceOpen\ =\ 2}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00040}00040\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00041}00041\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00042}\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_ae5d7f0ba6759749953e94555c9557cfb}{00042}}\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_ae5d7f0ba6759749953e94555c9557cfb}{SpotHelper}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}\ logService,\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_forex_service}{ForexService}}\ forexService,\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_alchemy_service}{AlchemyService}}\ alchemyService,\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_binance_service}{BinanceService}}\ binanceService,\ IOptions<TaskAPISettings>\ taskAPISettings,\ \mbox{\hyperlink{class_task_a_p_i_1_1_contexts_1_1_priceapp_context}{PriceappContext}}\ context,\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_internal_a_p_i_service}{InternalAPIService}}\ iapiService,\ IWebHostEnvironment\ env)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00043}00043\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00044}00044\ \ \ \ \ \ \ \ \ \_alchemyService\ =\ alchemyService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00045}00045\ \ \ \ \ \ \ \ \ \_settings\ =\ taskAPISettings.Value;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00046}00046\ \ \ \ \ \ \ \ \ \_logService\ =\ logService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00047}00047\ \ \ \ \ \ \ \ \ \_forexService\ =\ forexService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00048}00048\ \ \ \ \ \ \ \ \ \_binanceService\ =\ binanceService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00049}00049\ \ \ \ \ \ \ \ \ \_context\ =\ context;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00050}00050\ \ \ \ \ \ \ \ \ \_iapiService\ =\ iapiService;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00051}00051\ \ \ \ \ \ \ \ \ \_env\ =\ env;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00052}00052\ \ \ \ \ \ \ \ \ marketOpen\ =\ IsMarketOpen();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00053}00053\ \ \ \ \ \ \ \ \ marketStatusOverride\ =\ MarketStatusOverride();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00054}00054\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00055}00055\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00056}\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a7b75f44b3310036d4de7f0f2956bbac1}{00056}}\ \ \ \ \ \textcolor{keyword}{public}\ List<BaseSpot>\ \mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a7b75f44b3310036d4de7f0f2956bbac1}{PullSaveTrim}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00057}00057\ \ \ \ \ \{\ \ \ \ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00058}00058\ \ \ \ \ \ \ \ \ List<BaseSpot>\ finalSpotList\ =\ \textcolor{keyword}{new}\ List<BaseSpot>();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00059}00059\ \ \ \ \ \ \ \ \ var\ pullTime\ =\ DateTime.Now;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00060}00060\ \ \ \ \ \ \ \ \ var\ forexData\ =\ PullForexData(pullTime);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00061}00061\ \ \ \ \ \ \ \ \ var\ polygonOracleData\ =\ PullPolygonOracleData(pullTime);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00062}00062\ \ \ \ \ \ \ \ \ var\ oandaData\ =\ PullOandaData(pullTime);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00063}00063\ \ \ \ \ \ \ \ \ var\ binanceData\ =\ PullBinanceData(pullTime);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00064}00064\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00065}00065\ \ \ \ \ \ \ \ \ finalSpotList.AddRange(polygonOracleData);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00066}00066\ \ \ \ \ \ \ \ \ finalSpotList.AddRange(forexData);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00067}00067\ \ \ \ \ \ \ \ \ finalSpotList.AddRange(oandaData);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00068}00068\ \ \ \ \ \ \ \ \ finalSpotList.AddRange(binanceData);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00069}00069\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00070}00070\ \ \ \ \ \ \ \ \ \textcolor{comment}{//group\ by\ assetcode,\ take\ only\ groups\ >\ 0\ count}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00071}00071\ \ \ \ \ \ \ \ \ var\ assetGroups\ =\ finalSpotList.GroupBy(bs\ =>\ bs.AssetCode).Where(grp\ =>\ grp.Count()\ >\ 1);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00072}00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ grp\ \textcolor{keywordflow}{in}\ assetGroups)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00073}00073\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00074}00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (grp.Any(bs\ =>\ bs.Spot\ ==\ 0)\ \&\&\ !grp.All(bs\ =>\ bs.Spot\ ==\ 0))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00075}00075\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00076}00076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//group\ has\ some\ 0's\ but\ not\ all\ -\/\ remove\ 0's}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00077}00077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ bs\ \textcolor{keywordflow}{in}\ grp.Where(bs\ =>\ bs.Spot\ ==\ 0))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00078}00078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00079}00079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ finalSpotList.Remove(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00080}00080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00081}00081\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00082}00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!grp.All(bs\ =>\ bs.Spot\ ==\ 0))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00083}00083\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00084}00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//group\ has\ all\ 0's\ -\/\ remove\ all\ but\ one\ for\ placeholder}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00085}00085\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ bs\ \textcolor{keywordflow}{in}\ grp.Where(bs\ =>\ bs.Spot\ ==\ 0).Take(grp.Count()\ -\/\ 1))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00086}00086\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00087}00087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ finalSpotList.Remove(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00088}00088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00089}00089\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00090}00090\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00091}00091\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00092}00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}\ bs\ \textcolor{keywordflow}{in}\ finalSpotList.Where(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_ac34435c653855618d7586ac10a5f7218}{Spot}}\ ==\ 0))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00093}00093\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00094}00094\ \ \ \ \ \ \ \ \ \ \ \ \ RecyclePreviousSpot(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00095}00095\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00096}00096\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00097}00097\ \ \ \ \ \ \ \ \ \textcolor{comment}{//convert\ all\ usd\ and\ btc\ to\ aud\ excluding\ aud\ itself\ }}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00098}00098\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ audusd\ =\ Convert.ToDouble(finalSpotList.FirstOrDefault(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}}\ ==\ \textcolor{stringliteral}{"{}AUD"{}}\ \&\&\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a53f94494658ba0a6bb555b7d0346f60d}{Source}}\ ==\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a9cce11d1062ce85664de5bf6bb1da49e}{SourceName}})?.Spot);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00099}00099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (audusd\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00100}00100\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00101}00101\ \ \ \ \ \ \ \ \ \ \ \ \ var\ fallbackAUD\ =\ finalSpotList.FirstOrDefault(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}}\ ==\ \textcolor{stringliteral}{"{}AUD"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00102}00102\ \ \ \ \ \ \ \ \ \ \ \ \ audusd\ =\ Convert.ToDouble(fallbackAUD?.Spot);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00103}00103\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(fallbackAUD\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00104}00104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}polygon\ oracle\ AUD\ unavailable,\ NO\ FALLBACK\ SOURCE\ AVAILABLE,\ price\ \$\{audusd\}"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00105}00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00106}00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a5c2a67dbd8beb6f821c46b8d052d59ea}{LogInformation}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}polygon\ oracle\ AUD\ unavailable,\ falling\ back\ to\ \{fallbackAUD.Source\ \},\ price\ \$\{audusd\}"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00107}00107\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00108}00108\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ btcaud\ =\ Convert.ToDouble(finalSpotList.FirstOrDefault(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}}\ ==\ \textcolor{stringliteral}{"{}BTC"{}}\ \&\&\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a53103d0d5c3876af06947e4d7be0d541}{PairCode}}\ ==\ \textcolor{stringliteral}{"{}AUD"{}})?.Spot);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00109}00109\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (btcaud\ ==\ 0\ \&\&\ audusd\ >\ 0)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00110}00110\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00111}00111\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ btcusd\ =\ Convert.ToDouble(finalSpotList.FirstOrDefault(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}}\ ==\ \textcolor{stringliteral}{"{}BTC"{}}\ \&\&\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a53103d0d5c3876af06947e4d7be0d541}{PairCode}}\ ==\ \textcolor{stringliteral}{"{}USD"{}})?.Spot);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00112}00112\ \ \ \ \ \ \ \ \ \ \ \ \ btcaud\ =\ btcusd\ /\ audusd;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00113}00113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//comment\ out\ while\ using\ USD\ as\ default\ market}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00114}00114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\_logService.LogError(LogService.LogSources.SpotHelper,\ \$"{}binance\ feed\ BTCAUD\ unavailable,\ falling\ back\ to\ BTCUSD"{});}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00115}00115\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00116}00116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (audusd\ >\ 0)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00117}00117\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00118}00118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//convert\ usd\ values\ to\ aud\ except\ audusd}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00119}00119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ bs\ \textcolor{keywordflow}{in}\ finalSpotList.Where(bs\ =>\ bs.PairCode\ ==\ \textcolor{stringliteral}{"{}USD"{}}\ \&\&\ !(bs.AssetCode\ ==\ \textcolor{stringliteral}{"{}AUD"{}})))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00120}00120\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00121}00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.Spot\ =\ bs.Spot\ /\ audusd;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00122}00122\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.PairCode\ =\ \textcolor{stringliteral}{"{}AUD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00123}00123\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a6be037b34888bbcf6b47dca8eef472de}{LogDebug}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}converted\ \{bs.AssetCode\}\ from\ USD\ to\ AUD"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00124}00124\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00125}00125\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00126}00126\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00127}00127\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00128}00128\ \ \ \ \ \ \ \ \ \ \ \ \ \_iapiService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_internal_a_p_i_service_aeffeb1d3d59aeeab65dfe72691d21600}{SendEmail}}(\textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_email_post}{EmailPost}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00129}00129\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00130}00130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EmailFrom\ =\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_af39dc0933cd608b26e7bc4f82951d356}{GeneralSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_generalsettings_ac0a0b89d2e7cf7f820e5663a1a4cffbf}{NotificationEmailFrom}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00131}00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ EmailTo\ =\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_af39dc0933cd608b26e7bc4f82951d356}{GeneralSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_generalsettings_a25434a5471214771ae507f7152073898}{NotificationEmailTo}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00132}00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ NameFrom\ =\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_af39dc0933cd608b26e7bc4f82951d356}{GeneralSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_generalsettings_a082a8e92b97a7d83196f1d0056241042}{NotificationEmailName}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00133}00133\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Subject\ =\ \textcolor{stringliteral}{"{}Error\ getting\ AUD\ from\ price\ feeds"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00134}00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ HTMLBody\ =\ \$\textcolor{stringliteral}{"{}Task\ API\ was\ unable\ to\ find\ the\ AUD\ price\ in\ this\ round"{}}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00135}00135\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00136}00136\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}AUD\ not\ found,\ unable\ to\ convert\ USD\ and\ BTC\ values"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00137}00137\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00138}00138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (btcaud\ >\ 0)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00139}00139\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00140}00140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//convert\ btc\ values\ to\ aud}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00141}00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ bs\ \textcolor{keywordflow}{in}\ finalSpotList.Where(bs\ =>\ bs.PairCode\ ==\ \textcolor{stringliteral}{"{}BTC"{}}))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00142}00142\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00143}00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.Spot\ =\ bs.Spot\ *\ btcaud;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00144}00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.PairCode\ =\ \textcolor{stringliteral}{"{}AUD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00145}00145\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a6be037b34888bbcf6b47dca8eef472de}{LogDebug}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}converted\ \{bs.AssetCode\}\ from\ BTC\ to\ AUD"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00146}00146\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00147}00147\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00148}00148\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00149}00149\ \ \ \ \ \ \ \ \ \textcolor{comment}{//compare\ metal\ duplcates\ against\ thresholds}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00150}00150\ \ \ \ \ \ \ \ \ var\ compareGroups\ =\ finalSpotList.GroupBy(bs\ =>\ bs.AssetCode).Where(grp\ =>\ grp.Count()\ >\ 1);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00151}00151\ \ \ \ \ \ \ \ \ \textcolor{comment}{//XAU}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00152}00152\ \ \ \ \ \ \ \ \ var\ grpXAU\ =\ compareGroups.FirstOrDefault(grp\ =>\ grp.Key\ ==\textcolor{stringliteral}{"{}XAU"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00153}00153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (grpXAU\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00154}00154\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00155}00155\ \ \ \ \ \ \ \ \ \ \ \ \ var\ variations\ =\ \textcolor{keyword}{new}\ List<(string\ description,\ double\ variation)>();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00156}00156\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//primary\ value\ to\ compare\ all\ others\ against\ should\ be\ polygon\ oracle,\ otherwise\ choose\ first}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00157}00157\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}?\ primaryValue\ =\ grpXAU.FirstOrDefault(bs\ =>\ bs.Source==\_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a9cce11d1062ce85664de5bf6bb1da49e}{SourceName}})?.Spot\ ??}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00158}00158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ grpXAU.FirstOrDefault()?.Spot;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00159}00159\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (primaryValue\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00160}00160\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00161}00161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ bs\ \textcolor{keywordflow}{in}\ grpXAU)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00162}00162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00163}00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\%\ difference\ calculation}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00164}00164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ variations.Add((\$\textcolor{stringliteral}{"{}AssetCode:\ \{bs.AssetCode\}\ Source:\ \{bs.Source\}\ Primary\ Value:\ \{primaryValue.ToString()\}\ Comparison\ Value:\ \{bs.Spot\}"{}},\ ((\textcolor{keywordtype}{double})primaryValue\ -\/\ bs.Spot)\ /\ (((\textcolor{keywordtype}{double})primaryValue\ +\ bs.Spot)\ /\ 2)\ *\ 100));}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00165}00165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00166}00166\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00167}00167\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (variations.Any(var\ =>\ var.variation\ >\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_abce48cfdd32d7c339d09d27193deb7c4}{XAUFeedVariationThresholdPercent}}\ ||\ var.variation\ <\ -\/\_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_abce48cfdd32d7c339d09d27193deb7c4}{XAUFeedVariationThresholdPercent}}))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00168}00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}XAU\ feeds\ are\ outside\ variation\ threshold"{}},\ variations);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00169}00169\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00170}00170\ \ \ \ \ \ \ \ \ \textcolor{comment}{//XAG}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00171}00171\ \ \ \ \ \ \ \ \ var\ grpXAG\ =\ compareGroups.FirstOrDefault(grp\ =>\ grp.Key\ ==\ \textcolor{stringliteral}{"{}XAG"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00172}00172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (grpXAG\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00173}00173\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00174}00174\ \ \ \ \ \ \ \ \ \ \ \ \ var\ variations\ =\ \textcolor{keyword}{new}\ List<(string\ description,\ double\ variation)>();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00175}00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//primary\ value\ to\ compare\ all\ others\ against\ should\ be\ polygon\ oracle,\ otherwise\ choose\ first}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00176}00176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}?\ primaryValue\ =\ grpXAG.FirstOrDefault(bs\ =>\ bs.Source\ ==\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a9cce11d1062ce85664de5bf6bb1da49e}{SourceName}})?.Spot\ ??}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00177}00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ grpXAG.FirstOrDefault()?.Spot;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00178}00178\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (primaryValue\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00179}00179\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00180}00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ bs\ \textcolor{keywordflow}{in}\ grpXAG)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00181}00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00182}00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\%\ difference\ calculation}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00183}00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ variations.Add((\$\textcolor{stringliteral}{"{}AssetCode:\ \{bs.AssetCode\}\ Source:\ \{bs.Source\}\ Primary\ Value:\ \{primaryValue.ToString()\}\ Comparison\ Value:\ \{bs.Spot\}"{}},\ ((\textcolor{keywordtype}{double})primaryValue\ -\/\ bs.Spot)\ /\ (((\textcolor{keywordtype}{double})primaryValue\ +\ bs.Spot)\ /\ 2)\ *\ 100));}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00184}00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00185}00185\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00186}00186\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (variations.Any(var\ =>\ var.variation\ >\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_acf22a3188f3d0473175cbd5ac65dd2b9}{XAGFeedVariationThresholdPercent}}\ ||\ var.variation\ <\ -\/\_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_acf22a3188f3d0473175cbd5ac65dd2b9}{XAGFeedVariationThresholdPercent}}))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00187}00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}XAG\ feeds\ are\ outside\ variation\ threshold"{}},\ variations);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00188}00188\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00189}00189\ \ \ \ \ \ \ \ \ \textcolor{comment}{//AUD}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00190}00190\ \ \ \ \ \ \ \ \ var\ grpAUD\ =\ compareGroups.FirstOrDefault(grp\ =>\ grp.Key\ ==\ \textcolor{stringliteral}{"{}AUD"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00191}00191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (grpAUD\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00192}00192\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00193}00193\ \ \ \ \ \ \ \ \ \ \ \ \ var\ variations\ =\ \textcolor{keyword}{new}\ List<(string\ description,\ double\ variation)>();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00194}00194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//primary\ value\ to\ compare\ all\ others\ against\ should\ be\ polygon\ oracle,\ otherwise\ choose\ first}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00195}00195\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}?\ primaryValue\ =\ grpAUD.FirstOrDefault(bs\ =>\ bs.Source\ ==\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a9cce11d1062ce85664de5bf6bb1da49e}{SourceName}})?.Spot\ ??}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00196}00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ grpAUD.FirstOrDefault()?.Spot;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00197}00197\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (primaryValue\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00198}00198\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00199}00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ bs\ \textcolor{keywordflow}{in}\ grpAUD)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00200}00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00201}00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\%\ difference\ calculation}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00202}00202\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ variations.Add((\$\textcolor{stringliteral}{"{}AssetCode:\ \{bs.AssetCode\}\ Source:\ \{bs.Source\}\ Primary\ Value:\ \{primaryValue.ToString()\}\ Comparison\ Value:\ \{bs.Spot\}"{}},\ ((\textcolor{keywordtype}{double})primaryValue\ -\/\ bs.Spot)\ /\ (((\textcolor{keywordtype}{double})primaryValue\ +\ bs.Spot)\ /\ 2)\ *\ 100));}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00203}00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00204}00204\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00205}00205\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (variations.Any(var\ =>\ var.variation\ >\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_abe038aab4e92b88aab47caf734aa8a3e}{AUDFeedVariationThresholdPercent}}\ ||\ var.variation\ <\ -\/\_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_abe038aab4e92b88aab47caf734aa8a3e}{AUDFeedVariationThresholdPercent}}))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00206}00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}AUD\ feeds\ are\ outside\ variation\ threshold"{}},\ variations);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00207}00207\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00208}00208\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00209}00209\ \ \ \ \ \ \ \ \ \textcolor{comment}{//remove\ redundant/duplicate\ assets\ selecting\ preferred\ source\ or\ highest\ price}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00210}00210\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ grp\ \textcolor{keywordflow}{in}\ compareGroups)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00211}00211\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00212}00212\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//polygon\ oracle\ is\ preferred\ source}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00213}00213\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (grp.Any(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a53f94494658ba0a6bb555b7d0346f60d}{Source}}\ ==\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a9cce11d1062ce85664de5bf6bb1da49e}{SourceName}}))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00214}00214\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00215}00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//group\ has\ preferred\ source\ -\/\ remove\ others}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00216}00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ finalSpotList\ =\ finalSpotList.Except(grp.Where(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a53f94494658ba0a6bb555b7d0346f60d}{Source}}\ !=\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a9cce11d1062ce85664de5bf6bb1da49e}{SourceName}})).ToList();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00217}00217\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00218}00218\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00219}00219\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00220}00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//group\ has\ no\ preferred\ source\ -\/\ remove\ all\ but\ most\ expensive}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00221}00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ finalSpotList\ =\ finalSpotList.Except(grp.Where(bs\ =>\ bs\ !=\ grp.OrderByDescending(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_ac34435c653855618d7586ac10a5f7218}{Spot}}).First())).ToList();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00222}00222\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00223}00223\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00224}00224\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00225}00225\ \ \ \ \ \ \ \ \ GenerateSpecialData(pullTime,\ finalSpotList);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00226}00226\ \ \ \ \ \ \ \ \ \_context.\mbox{\hyperlink{class_task_a_p_i_1_1_contexts_1_1_priceapp_context_a5e7d6eb59fabb7c28af0d9a97551a83d}{BaseSpots}}.AddRange(finalSpotList);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00227}00227\ \ \ \ \ \ \ \ \ \_context.SaveChanges();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00228}00228\ \ \ \ \ \ \ \ \ TrimSpotData();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00229}00229\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ finalSpotList;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00230}00230\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00231}00231\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00236}00236\ \ \ \ \ \textcolor{keyword}{private}\ List<BaseSpot>\ PullPolygonOracleData(DateTime\ pullTime)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00237}00237\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00238}00238\ \ \ \ \ \ \ \ \ List<BaseSpot>\ spotList\ =\ \textcolor{keyword}{new}\ List<BaseSpot>();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00239}00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ x\ \textcolor{keywordflow}{in}\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_acd65b4bef8f036a74d81ec16546914ac}{Assets}})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00240}00240\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00241}00241\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ spot\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00242}00242\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ pairCode\ =\ \textcolor{stringliteral}{"{}USD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00243}00243\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if\ market\ open,\ pull\ data\ and\ create\ basespot\ with\ live\ data,\ otherwise\ create\ dummy\ basespot\ with\ 0}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00244}00244\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a89a665897ed47f9b7065ce771100b83c}{CanSync}}())}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00245}00245\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00246}00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_polygon_oracle_1_1_latest_round_data_response}{LatestRoundDataResponse}}\ latestRoundResponse\ =\ \_alchemyService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_alchemy_service_a8db06c3be654656ef61b3177a0624787}{LatestRoundData}}(x.Contract);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00247}00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a6be037b34888bbcf6b47dca8eef472de}{LogDebug}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}latest\ round\ data\ from\ polygon\ oracle\ for\ \{x.AssetCode\}"{}},\ latestRoundResponse);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00248}00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (latestRoundResponse\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00249}00249\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00250}00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}response\ from\ polygon\ oracle\ service\ is\ null"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00251}00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00252}00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00253}00253\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00254}00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00255}00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00256}00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//check\ feed\ time\ variation}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00257}00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ feedTime\ =\ DateTimeOffset.FromUnixTimeSeconds(\textcolor{keywordtype}{long}.Parse(latestRoundResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_polygon_oracle_1_1_latest_round_data_response_a7db191933c35e3102a10675915da067b}{updatedAt}}.ToString())).UtcDateTime.ToLocalTime();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00258}00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((pullTime\ -\/\ feedTime).TotalMinutes\ >\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_ab263694d641e1015ecc390a0f685d585}{TimeDifferenceThresholdMinutes}})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00259}00259\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00260}00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}polygon\ oracle\ time\ variation\ is\ above\ threshold"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00261}00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00262}00262\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00263}00263\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00264}00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spot\ =\ Convert.ToDouble(latestRoundResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_polygon_oracle_1_1_latest_round_data_response_a8fe6a5db07c172b21544944fb620cbaa}{answer}}.ToString())\ /\ Math.Pow(10,\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a4f533d1a75a099c6f314b5b176b3c468}{ContractDecimals}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00265}00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00266}00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00267}00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (Exception\ ex)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00268}00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00269}00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a78c9df658858fa3099eed69421423898}{LogException}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}exception\ reading\ values\ from\ polygon\ oracle\ response"{}},\ ex);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00270}00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00271}00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00272}00272\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00273}00273\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}\ bs\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00274}00274\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00275}00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AssetCode\ =\ x.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00276}00276\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PairCode\ =\ pairCode,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00277}00277\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Per\ =\ x.AssetCode\ ==\ \textcolor{stringliteral}{"{}AUD"{}}\ ?\ \textcolor{stringliteral}{"{}\$"{}}\ :\ \textcolor{stringliteral}{"{}oz"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00278}00278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Source\ =\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a9cce11d1062ce85664de5bf6bb1da49e}{SourceName}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00279}00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PullTime\ =\ pullTime,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00280}00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Spot\ =\ spot}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00281}00281\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00282}00282\ \ \ \ \ \ \ \ \ \ \ \ \ spotList.Add(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00283}00283\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00284}00284\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spotList;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00285}00285\ \ \ \ \ \ \ \ \ \textcolor{comment}{//DEBUG}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00286}00286\ \ \ \ \ \ \ \ \ \textcolor{comment}{//spotList.First(x\ =>\ x.AssetCode\ ==\ "{}AUD"{}).Spot\ =\ 0;}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00287}00287\ \ \ \ \ \ \ \ \ \textcolor{comment}{//return\ spotList;}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00288}00288\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00289}00289\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00294}00294\ \ \ \ \ \textcolor{keyword}{private}\ List<BaseSpot>\ PullForexData(DateTime\ pullTime)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00295}00295\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00296}00296\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ feedError\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00297}00297\ \ \ \ \ \ \ \ \ List<BaseSpot>\ spotList\ =\ \textcolor{keyword}{new}\ List<BaseSpot>();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00298}00298\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response}{ForexResponse}}?\ forexResponse\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00299}00299\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ market\ open,\ pull\ data,\ otherwise\ leave\ forexResponse\ as\ null}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00300}00300\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a89a665897ed47f9b7065ce771100b83c}{CanSync}}())\ \{\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00301}00301\ \ \ \ \ \ \ \ \ \ \ \ \ forexResponse\ =\ \_forexService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_forex_service_a45ca436cc529b87e410d8b208abea3b1}{PullFeed}}();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00302}00302\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a6be037b34888bbcf6b47dca8eef472de}{LogDebug}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}latest\ data\ from\ forex\ feed\ for"{}},\ forexResponse);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00303}00303\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (forexResponse\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00304}00304\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00305}00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ feedError\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00306}00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}response\ from\ forex\ feed\ service\ is\ null"{}},\ forexResponse);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00307}00307\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00308}00308\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00309}00309\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00310}00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00311}00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00312}00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//check\ feed\ time\ variation}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00313}00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ feedTime\ =\ DateTimeOffset.FromUnixTimeSeconds(\textcolor{keywordtype}{long}.Parse(forexResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_a887a42c887a5585d9c99c9d8694fa263}{head}}.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_1_1_head_adf13bd6ff354f29411018a289d04143f}{utc\_time}}.ToString())).UtcDateTime.ToLocalTime();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00314}00314\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((pullTime\ -\/\ feedTime).TotalMinutes\ >\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_ab263694d641e1015ecc390a0f685d585}{TimeDifferenceThresholdMinutes}})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00315}00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00316}00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ feedError\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00317}00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}time\ variation\ beyond\ threshold\ for\ forex\ feed\ data"{}},\ forexResponse);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00318}00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00319}00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00320}00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}(Exception\ ex)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00321}00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00322}00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ feedError\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00323}00323\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a78c9df658858fa3099eed69421423898}{LogException}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}exception\ checking\ feed\ time\ from\ forex\ feed\ response"{}},\ forexResponse,\ ex);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00324}00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00325}00325\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00326}00326\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00327}00327\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ x\ \textcolor{keywordflow}{in}\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_a0eb4318ad18306881384e7097caaa9f0}{ForexSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_forexsettings_aac3ce432f05195e369540151cedc8c23}{Assets}})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00328}00328\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00329}00329\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ spot\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00330}00330\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ pairCode\ =\ \textcolor{stringliteral}{"{}AUD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00331}00331\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ forexResponse\ popualted,\ create\ basespots\ with\ live\ data.\ \ if\ forexResponse\ is\ null,\ create\ dummy\ basespots\ with\ 0}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00332}00332\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!feedError\ \&\&\ forexResponse\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00333}00333\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00334}00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00335}00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00336}00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!\textcolor{keywordtype}{double}.TryParse(((\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response}{ForexResponse}}.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_1_1_data}{Data}}.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_1_1_data_1_1_spot_instance}{SpotInstance}}[])forexResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_a945a66fb427a67f5d20d34c39b869d74}{data}}.GetType().GetProperty(\$\textcolor{stringliteral}{"{}\{x.AssetCode\}AUD"{}})?.GetValue(forexResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_a945a66fb427a67f5d20d34c39b869d74}{data}}))?[0].ask,\ out\ spot))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00337}00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00338}00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{double}.TryParse(((\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response}{ForexResponse}}.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_1_1_data}{Data}}.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_1_1_data_1_1_spot_instance}{SpotInstance}}[])forexResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_a945a66fb427a67f5d20d34c39b869d74}{data}}.GetType().GetProperty(\$\textcolor{stringliteral}{"{}\{x.AssetCode\}USD"{}})?.GetValue(forexResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_forex_response_a945a66fb427a67f5d20d34c39b869d74}{data}}))?[0].ask,\ out\ spot))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00339}00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00340}00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}unable\ to\ find\ suitable\ pair\ in\ forex\ feed\ for\ \{x.AssetCode\}"{}},\ forexResponse);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00341}00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00342}00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00343}00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00344}00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pairCode\ =\ \textcolor{stringliteral}{"{}USD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00345}00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00346}00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00347}00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00348}00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}(Exception\ ex)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00349}00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00350}00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a78c9df658858fa3099eed69421423898}{LogException}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}exception\ reading\ spot\ from\ forex\ feed\ response\ for\ \{x.AssetCode\}"{}},\ forexResponse,\ ex);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00351}00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00352}00352\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00353}00353\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}\ bs\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00354}00354\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00355}00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AssetCode\ =\ x.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00356}00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PairCode\ =\ pairCode,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00357}00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Per\ =\ x.AssetCode\ ==\ \textcolor{stringliteral}{"{}AUD"{}}\ ?\ \textcolor{stringliteral}{"{}\$"{}}\ :\ \textcolor{stringliteral}{"{}oz"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00358}00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Source\ =\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_a0eb4318ad18306881384e7097caaa9f0}{ForexSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_forexsettings_a81e4b95c98d601fcb21cc42c2b4a32ba}{SourceName}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00359}00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PullTime\ =\ pullTime,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00360}00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Spot\ =\ spot}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00361}00361\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00362}00362\ \ \ \ \ \ \ \ \ \ \ \ \ spotList.Add(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00363}00363\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00364}00364\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spotList;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00365}00365\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00366}00366\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00371}00371\ \ \ \ \ \textcolor{keyword}{private}\ List<BaseSpot>\ PullOandaData(DateTime\ pullTime)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00372}00372\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00373}00373\ \ \ \ \ \ \ \ \ List<BaseSpot>\ spotList\ =\ \textcolor{keyword}{new}\ List<BaseSpot>();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00374}00374\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a89a665897ed47f9b7065ce771100b83c}{CanSync}}())}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00375}00375\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00376}00376\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ x\ \textcolor{keywordflow}{in}\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_a5dfa2605f71620cafd59a7159f2c3488}{OandaSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_oandasettings_ab542487a4c6f5b4e9e39d2d63b70bf14}{Assets}})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00377}00377\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00378}00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ spot\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00379}00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ oandaAssetResponse\ =\ \_iapiService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_internal_a_p_i_service_aa614614518048e1244ae357de18425df}{GetOandaInstrumentPriceUSD}}(x.AssetCode);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00380}00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a6be037b34888bbcf6b47dca8eef472de}{LogDebug}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}latest\ data\ from\ oanda\ feed\ for\ \{x.AssetCode\}"{}},\ oandaAssetResponse);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00381}00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (oandaAssetResponse\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00382}00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00383}00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}response\ from\ oanda\ via\ internalapi\ for\ asset\ \{x.AssetCode\}\ is\ null"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00384}00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00385}00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00386}00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00387}00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00388}00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00389}00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00390}00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//check\ feed\ time\ variation}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00391}00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ feedTime\ =\ Convert.ToDateTime(oandaAssetResponse.prices?.FirstOrDefault()?.time).ToLocalTime();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00392}00392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ ((pullTime\ -\/\ feedTime).TotalMinutes\ >\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_ab263694d641e1015ecc390a0f685d585}{TimeDifferenceThresholdMinutes}})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00393}00393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00394}00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}time\ variation\ beyond\ threshold\ for\ oanda\ feed\ data\ for\ asset\ \{x.AssetCode\}"{}},\ oandaAssetResponse);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00395}00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00396}00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00397}00397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (Exception\ ex)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00398}00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00399}00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a78c9df658858fa3099eed69421423898}{LogException}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}exception\ checking\ feed\ time\ from\ oanda\ feed\ response\ for\ asset\ \{x.AssetCode\}"{}},\ oandaAssetResponse,\ ex);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00400}00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00401}00401\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//try\ first\ ask}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00402}00402\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{double}.TryParse(oandaAssetResponse?.prices?.FirstOrDefault()?.asks?.OrderBy(ask\ =>\ ask.price).FirstOrDefault()?.price\ ??\ \textcolor{stringliteral}{"{}0"{}},\ out\ spot)\ ||\ spot\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00403}00403\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00404}00404\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//try\ closeoutask}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00405}00405\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{double}.TryParse(oandaAssetResponse?.prices?.FirstOrDefault()?.closeoutAsk\ ??\ \textcolor{stringliteral}{"{}0"{}},\ out\ spot)\ ||\ spot\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00406}00406\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00407}00407\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//try\ first\ bid}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00408}00408\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{double}.TryParse(oandaAssetResponse?.prices?.FirstOrDefault()?.bids?.OrderByDescending(bid\ =>\ bid.price).FirstOrDefault()?.price\ ??\ \textcolor{stringliteral}{"{}0"{}},\ out\ spot)\ ||\ spot\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00409}00409\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00410}00410\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}unable\ to\ find\ suitable\ price\ in\ oanda\ feed\ for\ \{x.AssetCode\}"{}},\ oandaAssetResponse);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00411}00411\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00412}00412\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00413}00413\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00414}00414\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00415}00415\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (Exception\ ex)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00416}00416\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00417}00417\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a78c9df658858fa3099eed69421423898}{LogException}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}exception\ getting\ spot\ from\ oanda\ feed\ for\ \{x.AssetCode\}"{}},\ oandaAssetResponse,\ ex);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00418}00418\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00419}00419\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}\ bs\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00420}00420\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00421}00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AssetCode\ =\ x.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00422}00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PairCode\ =\ \textcolor{stringliteral}{"{}USD"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00423}00423\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Per\ =\ x.AssetCode\ ==\ \textcolor{stringliteral}{"{}AUD"{}}\ ?\ \textcolor{stringliteral}{"{}\$"{}}\ :\ \textcolor{stringliteral}{"{}oz"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00424}00424\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Source\ =\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_a5dfa2605f71620cafd59a7159f2c3488}{OandaSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_oandasettings_af22b7fd07aa26d2b2fd4d28c4179f83b}{SourceName}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00425}00425\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PullTime\ =\ pullTime,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00426}00426\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Spot\ =\ spot}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00427}00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00428}00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ spotList.Add(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00429}00429\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00430}00430\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00431}00431\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spotList;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00432}00432\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00433}00433\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00438}00438\ \ \ \ \ \textcolor{keyword}{private}\ List<BaseSpot>\ PullBinanceData(DateTime\ pullTime)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00439}00439\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00440}00440\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ feedError\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00441}00441\ \ \ \ \ \ \ \ \ List<BaseSpot>\ spotList\ =\ \textcolor{keyword}{new}\ List<BaseSpot>();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00442}00442\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_binance_response}{BinanceResponse}}\ binanceResponse\ =\ \_binanceService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_binance_service_a5863f72c89f66991b6ea2172de8e4687}{PullFeed}}();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00443}00443\ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a6be037b34888bbcf6b47dca8eef472de}{LogDebug}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}latest\ data\ from\ binance\ feed"{}},\ binanceResponse);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00444}00444\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (binanceResponse\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00445}00445\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00446}00446\ \ \ \ \ \ \ \ \ \ \ \ \ feedError\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00447}00447\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}response\ from\ binance\ feed\ service\ is\ null"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00448}00448\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00449}00449\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ x\ \textcolor{keywordflow}{in}\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_a127cce7c28a6e430b091679ca27ef9a7}{BinanceSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_binancesettings_a0359754b8dd571a50996e9d5fdf21c24}{Assets}})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00450}00450\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00451}00451\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{double}\ spot\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00452}00452\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{string}\ pairCode\ =\ \textcolor{stringliteral}{"{}USD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00453}00453\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!feedError)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00454}00454\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00455}00455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00456}00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00457}00457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{double}.TryParse(binanceResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_binance_response_abcf25f174de498b1b8b35ed21ad8ad44}{Assets}}.FirstOrDefault(ass\ =>\ ass.symbol\ ==\ \$\textcolor{stringliteral}{"{}\{x.AssetCode\}USDT"{}})?.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_binance_response_1_1_asset_aff5192e877aa1a4560e421e50df0b59d}{price}},\ out\ spot))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00458}00458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00459}00459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{double}.TryParse(binanceResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_binance_response_abcf25f174de498b1b8b35ed21ad8ad44}{Assets}}.FirstOrDefault(ass\ =>\ ass.symbol\ ==\ \$\textcolor{stringliteral}{"{}\{x.AssetCode\}AUD"{}})?.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_binance_response_1_1_asset_aff5192e877aa1a4560e421e50df0b59d}{price}},\ out\ spot))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00460}00460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00461}00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!\textcolor{keywordtype}{double}.TryParse(binanceResponse.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_binance_response_abcf25f174de498b1b8b35ed21ad8ad44}{Assets}}.FirstOrDefault(ass\ =>\ ass.symbol\ ==\ \$\textcolor{stringliteral}{"{}\{x.AssetCode\}BTC"{}})?.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_binance_response_1_1_asset_aff5192e877aa1a4560e421e50df0b59d}{price}},\ out\ spot))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00462}00462\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00463}00463\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}unable\ to\ find\ suitable\ pair\ in\ binance\ feed\ for\ \{x.AssetCode\}"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00464}00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00465}00465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//btc\ pair\ matched}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00466}00466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00467}00467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pairCode\ =\ \textcolor{stringliteral}{"{}BTC"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00468}00468\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00469}00469\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00470}00470\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//usdt\ pair\ matched}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00471}00471\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00472}00472\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ pairCode\ =\ \textcolor{stringliteral}{"{}AUD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00473}00473\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00474}00474\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00475}00475\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00476}00476\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}(Exception\ ex)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00477}00477\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00478}00478\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a78c9df658858fa3099eed69421423898}{LogException}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}exception\ reading\ spot\ from\ binance\ feed\ response\ for\ \{x.AssetCode\}"{}},\ ex);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00479}00479\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00480}00480\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00481}00481\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}\ bs\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00482}00482\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00483}00483\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AssetCode\ =\ x.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00484}00484\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PairCode\ =\ pairCode,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00485}00485\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Per\ =\ \textcolor{stringliteral}{"{}coin"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00486}00486\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Source\ =\ \_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_a127cce7c28a6e430b091679ca27ef9a7}{BinanceSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_binancesettings_a599c1e6c9503b054c6805069f0b7c787}{SourceName}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00487}00487\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PullTime\ =\ pullTime,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00488}00488\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Spot\ =\ spot\ \textcolor{comment}{//if\ error,\ enter\ 0\ value}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00489}00489\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00490}00490\ \ \ \ \ \ \ \ \ \ \ \ \ spotList.Add(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00491}00491\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00492}00492\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spotList;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00493}00493\ \ \ \ \ \ \ \ \ \textcolor{comment}{//DEBUG}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00494}00494\ \ \ \ \ \ \ \ \ \textcolor{comment}{//spotList.First(x\ =>\ x.AssetCode\ ==\ "{}ETH"{}).Spot\ =\ 0;}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00495}00495\ \ \ \ \ \ \ \ \ \textcolor{comment}{//spotList.First(x\ =>\ x.AssetCode\ ==\ "{}BTC"{}).Spot\ =\ 0;}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00496}00496\ \ \ \ \ \ \ \ \ \textcolor{comment}{//return\ spotList;}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00497}00497\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00498}00498\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00502}00502\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{void}\ GenerateSpecialData(DateTime\ pullTime,\ List<BaseSpot>\ finalSpotList)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00503}00503\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00504}00504\ \ \ \ \ \ \ \ \ \textcolor{comment}{//USDTAUD}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00505}00505\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}\ bs\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00506}00506\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}?\ bsOriginal\ =\ finalSpotList.FirstOrDefault(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}}\ ==\ \textcolor{stringliteral}{"{}AUD"{}}\ \&\&\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a53103d0d5c3876af06947e4d7be0d541}{PairCode}}\ ==\ \textcolor{stringliteral}{"{}USD"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00507}00507\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bsOriginal\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00508}00508\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00509}00509\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//cant\ find\ match,\ create\ dummy\ entry}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00510}00510\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}unable\ to\ find\ suitable\ pair\ in\ finalSpotList\ feed\ for\ USDT"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00511}00511\ \ \ \ \ \ \ \ \ \ \ \ \ bs.AssetCode\ =\ \textcolor{stringliteral}{"{}USDT"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00512}00512\ \ \ \ \ \ \ \ \ \ \ \ \ bs.PairCode\ =\ \textcolor{stringliteral}{"{}AUD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00513}00513\ \ \ \ \ \ \ \ \ \ \ \ \ bs.Per\ =\ \textcolor{stringliteral}{"{}coin"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00514}00514\ \ \ \ \ \ \ \ \ \ \ \ \ bs.Source\ =\ \textcolor{stringliteral}{"{}None"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00515}00515\ \ \ \ \ \ \ \ \ \ \ \ \ bs.PullTime\ =\ pullTime;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00516}00516\ \ \ \ \ \ \ \ \ \ \ \ \ bs.Spot\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00517}00517\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00518}00518\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00519}00519\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00520}00520\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//use\ current\ matching\ metal\ spot\ and\ convert\ to\ grams}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00521}00521\ \ \ \ \ \ \ \ \ \ \ \ \ bs.AssetCode\ =\ \textcolor{stringliteral}{"{}USDT"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00522}00522\ \ \ \ \ \ \ \ \ \ \ \ \ bs.PairCode\ =\ \textcolor{stringliteral}{"{}AUD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00523}00523\ \ \ \ \ \ \ \ \ \ \ \ \ bs.Per\ =\ \textcolor{stringliteral}{"{}coin"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00524}00524\ \ \ \ \ \ \ \ \ \ \ \ \ bs.Source\ =\ bsOriginal.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a53f94494658ba0a6bb555b7d0346f60d}{Source}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00525}00525\ \ \ \ \ \ \ \ \ \ \ \ \ bs.PullTime\ =\ bsOriginal.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_abbb6466c0a299a01a982efb772382e5d}{PullTime}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00526}00526\ \ \ \ \ \ \ \ \ \ \ \ \ bs.Spot\ =\ 1\ /\ bsOriginal.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_ac34435c653855618d7586ac10a5f7218}{Spot}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00527}00527\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00528}00528\ \ \ \ \ \ \ \ \ finalSpotList.Add(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00529}00529\ \ \ \ \ \ \ \ \ \textcolor{comment}{//GSS\ tokens}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00530}00530\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (var\ x\ \textcolor{keywordflow}{in}\ \textcolor{keyword}{new}[]\ \{\ \textcolor{keyword}{new}\ \{\ AssetCode\ =\ \textcolor{stringliteral}{"{}AUS"{}},\ Copy\ =\ \textcolor{stringliteral}{"{}XAU"{}}\ \},\ \textcolor{keyword}{new}\ \{\ AssetCode\ =\ \textcolor{stringliteral}{"{}AGS"{}},\ Copy\ =\ \textcolor{stringliteral}{"{}XAG"{}}\ \}\ \})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00531}00531\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00532}00532\ \ \ \ \ \ \ \ \ \ \ \ \ bs\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00533}00533\ \ \ \ \ \ \ \ \ \ \ \ \ bsOriginal\ =\ finalSpotList.FirstOrDefault(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}}\ ==\ x.Copy);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00534}00534\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bsOriginal\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00535}00535\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00536}00536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//cant\ find\ match,\ create\ dummy\ entry}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00537}00537\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}unable\ to\ find\ suitable\ pair\ in\ finalSpotList\ feed\ for\ \{x.AssetCode\}"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00538}00538\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.AssetCode\ =\ x.AssetCode;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00539}00539\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.PairCode\ =\ \textcolor{stringliteral}{"{}AUD"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00540}00540\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.Per\ =\ \textcolor{stringliteral}{"{}coin"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00541}00541\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.Source\ =\ \textcolor{stringliteral}{"{}none"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00542}00542\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.PullTime\ =\ pullTime;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00543}00543\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.Spot\ =\ 0;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00544}00544\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00545}00545\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00546}00546\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00547}00547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//use\ current\ matching\ metal\ spot\ and\ convert\ to\ grams}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00548}00548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.AssetCode\ =\ x.AssetCode;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00549}00549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.PairCode\ =\ bsOriginal.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a53103d0d5c3876af06947e4d7be0d541}{PairCode}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00550}00550\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.Per\ =\ \textcolor{stringliteral}{"{}coin"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00551}00551\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.Source\ =\ bsOriginal.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a53f94494658ba0a6bb555b7d0346f60d}{Source}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00552}00552\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.PullTime\ =\ bsOriginal.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_abbb6466c0a299a01a982efb772382e5d}{PullTime}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00553}00553\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bs.Spot\ =\ bsOriginal.Spot\ /\ tOzGrams;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00554}00554\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00555}00555\ \ \ \ \ \ \ \ \ \ \ \ \ finalSpotList.Add(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00556}00556\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00557}00557\ \ \ \ \ \ \ \ \ \textcolor{comment}{//AUDD\ Token}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00558}00558\ \ \ \ \ \ \ \ \ bs\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00559}00559\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00560}00560\ \ \ \ \ \ \ \ \ \ \ \ \ AssetCode\ =\ \textcolor{stringliteral}{"{}AUDD"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00561}00561\ \ \ \ \ \ \ \ \ \ \ \ \ PairCode\ =\ \textcolor{stringliteral}{"{}AUD"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00562}00562\ \ \ \ \ \ \ \ \ \ \ \ \ Per\ =\ \textcolor{stringliteral}{"{}coin"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00563}00563\ \ \ \ \ \ \ \ \ \ \ \ \ Source\ =\ \textcolor{stringliteral}{"{}Static"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00564}00564\ \ \ \ \ \ \ \ \ \ \ \ \ PullTime\ =\ pullTime,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00565}00565\ \ \ \ \ \ \ \ \ \ \ \ \ Spot\ =\ 1}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00566}00566\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00567}00567\ \ \ \ \ \ \ \ \ finalSpotList.Add(bs);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00568}00568\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00569}00569\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00573}00573\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{void}\ RecyclePreviousSpot(\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot}{BaseSpot}}\ bs)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00574}00574\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00575}00575\ \ \ \ \ \ \ \ \ var\ bsRecycle\ =\ \_context.\mbox{\hyperlink{class_task_a_p_i_1_1_contexts_1_1_priceapp_context_a5e7d6eb59fabb7c28af0d9a97551a83d}{BaseSpots}}.Where(bsr\ =>\ bsr.AssetCode\ ==\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_a9fa574ef36b5343f32a53d5edd7addb4}{AssetCode}})?.OrderByDescending(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_abbb6466c0a299a01a982efb772382e5d}{PullTime}}).Take(1)?.FirstOrDefault();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00576}00576\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (bsRecycle\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00577}00577\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00578}00578\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a6be037b34888bbcf6b47dca8eef472de}{LogDebug}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}recycling\ spot\ for\ \{bs.AssetCode\}\ from\ database"{}},\ bsRecycle);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00579}00579\ \ \ \ \ \ \ \ \ \ \ \ \ bs.PairCode\ =\ bsRecycle.PairCode;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00580}00580\ \ \ \ \ \ \ \ \ \ \ \ \ bs.Source\ =\ \textcolor{stringliteral}{"{}database"{}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00581}00581\ \ \ \ \ \ \ \ \ \ \ \ \ bs.Spot\ =\ bsRecycle.Spot;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00582}00582\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00583}00583\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00584}00584\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00585}00585\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \$\textcolor{stringliteral}{"{}cannot\ recycle\ spot\ for\ \{bs.AssetCode\}\ from\ database"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00586}00586\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00587}00587\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00588}00588\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00589}00589\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{void}\ TrimSpotData()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00590}00590\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00591}00591\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\_context.Database.ExecuteSqlAsync(\$"{}delete\ from\ basespots\ where\ pulltime\ <\ \{DateTime.Now.AddDays(-\/\_settings.SpotFeedSettings.DaysToKeepSpotData)\}"{});}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00592}00592\ \ \ \ \ \ \ \ \ \_context.\mbox{\hyperlink{class_task_a_p_i_1_1_contexts_1_1_priceapp_context_a5e7d6eb59fabb7c28af0d9a97551a83d}{BaseSpots}}.Where(bs\ =>\ bs.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_base_spot_abbb6466c0a299a01a982efb772382e5d}{PullTime}}\ <\ DateTime.Now.AddDays(-\/\_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_abc5a23cce7a98ce3cd109ecb1c3122ae}{SpotFeedSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_spotfeedsettings_abb0c70613a3122807a0a9f0b4dd57b50}{DaysToKeepSpotData}})).ExecuteDelete();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00593}00593\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00594}00594\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00595}\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a1d8458171af3cac5a7fc1fc1f35de115}{00595}}\ \ \ \ \ \textcolor{keyword}{public}\ (\textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a1d8458171af3cac5a7fc1fc1f35de115}{Error}},\ \textcolor{keywordtype}{object}?\ Result)\ \mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a6b975ced6fddc4826a8950c8a250b926}{SaveDailySpot}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00596}00596\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00597}00597\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ isDebug\ =\ \_env.IsDevelopment()\ ||\ \_env.IsStaging();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00598}00598\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00599}00599\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00600}00600\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ Year\ =\ DateTime.Now.Year;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00601}00601\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ Month\ =\ DateTime.Now.Month;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00602}00602\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ Day\ =\ DateTime.Now.Day;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00603}00603\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//5\ mins\ before\ is\ ok,\ allow\ 1\ hr\ after\ in\ case\ retries\ are\ required}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00604}00604\ \ \ \ \ \ \ \ \ \ \ \ \ var\ WindowOpen\ =\ \textcolor{keyword}{new}\ DateTime(Year,\ Month,\ Day,\ 15,\ 55,\ 0);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00605}00605\ \ \ \ \ \ \ \ \ \ \ \ \ var\ WindowClose\ =\ \textcolor{keyword}{new}\ DateTime(Year,\ Month,\ Day,\ 16,\ 05,\ 0);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00606}00606\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isDebug\ \&\&\ !(DateTime.Now\ >\ WindowOpen\ \&\ DateTime.Now\ <\ WindowClose))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00607}00607\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{false},\ \textcolor{keyword}{new}\ \{\ success\ =\ \textcolor{keyword}{false},\ message\ =\ \textcolor{stringliteral}{"{}request\ does\ not\ fall\ within\ daily\ save\ time\ window"{}}\ \});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00608}00608\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//check\ if\ done\ today\ already}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00609}00609\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!isDebug\ \&\&\ \_context.\mbox{\hyperlink{class_task_a_p_i_1_1_contexts_1_1_priceapp_context_a0a63b303899246b496a42f08da57bd43}{DailyCloses}}.Where(dc\ =>\ dc.Year\ ==\ Year\ \&\&\ dc.Month\ ==\ Month\ \&\&\ dc.Day\ ==\ Day).Count()\ >\ 0)\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00610}00610\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{false},\ \textcolor{keyword}{new}\ \{\ success\ =\ \textcolor{keyword}{false},\ message\ =\ \textcolor{stringliteral}{"{}daily\ closes\ already\ completed\ for\ today"{}},\ Data\ =\ \_context.\mbox{\hyperlink{class_task_a_p_i_1_1_contexts_1_1_priceapp_context_a0a63b303899246b496a42f08da57bd43}{DailyCloses}}.Where(dc\ =>\ dc.Year\ ==\ Year\ \&\&\ dc.Month\ ==\ Month\ \&\&\ dc.Day\ ==\ Day).ToList()\ \});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00611}00611\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//get\ current\ asset\ list\ from\ priceapp}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00612}00612\ \ \ \ \ \ \ \ \ \ \ \ \ var\ assetList\ =\ \_iapiService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_internal_a_p_i_service_a7e3600841f53749e6c915ace609dfa11}{PriceappAssets}}();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00613}00613\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (assetList\ ==\ \textcolor{keyword}{null}\ ||\ assetList.Count\ ==\ 0)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00614}00614\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00615}00615\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{true},\ \textcolor{keyword}{new}\ \{\ success\ =\ \textcolor{keyword}{false},\ message\ =\ \textcolor{stringliteral}{"{}asset\ list\ from\ priceapp\ was\ null"{}}\ \});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00616}00616\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00617}00617\ \ \ \ \ \ \ \ \ \ \ \ \ List<DailyClose>\ dailyCloses\ =\ \textcolor{keyword}{new}\ List<DailyClose>();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00618}00618\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//create\ a\ daily\ close\ for\ AUD}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00619}00619\ \ \ \ \ \ \ \ \ \ \ \ \ var\ first\ =\ assetList.FirstOrDefault();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00620}00620\ \ \ \ \ \ \ \ \ \ \ \ \ var\ audusd\ =\ Math.Truncate(10000\ *\ first.audusd)\ /\ 10000;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00621}00621\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_daily_close}{DailyClose}}\ AUDClose\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_daily_close}{DailyClose}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00622}00622\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00623}00623\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Year\ =\ Year,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00624}00624\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Month\ =\ Month,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00625}00625\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Day\ =\ Day,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00626}00626\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AssetCode\ =\ \textcolor{stringliteral}{"{}AUD"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00627}00627\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PairCode\ =\ \textcolor{stringliteral}{"{}USD"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00628}00628\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Per\ =\ \textcolor{stringliteral}{"{}\$"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00629}00629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Buy\ =\ audusd,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00630}00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Spot\ =\ audusd,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00631}00631\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Sell\ =\ audusd}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00632}00632\ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00633}00633\ \ \ \ \ \ \ \ \ \ \ \ \ dailyCloses.Add(AUDClose);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00634}00634\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//create\ daily\ close\ for\ all\ else}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00635}00635\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{foreach}\ (\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_priceapp_asset}{PriceappAsset}}\ x\ \textcolor{keywordflow}{in}\ assetList)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00636}00636\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00637}00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (x.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_priceapp_asset_acb2a7c7f2ddd8fa7c579322de264f035}{assetCode}}\ ==\ \textcolor{stringliteral}{"{}XX1"{}})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00638}00638\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00639}00639\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ all\ assets\ from\ internal\ api\ are\ AUD}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00640}00640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_daily_close}{DailyClose}}\ dc\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_daily_close}{DailyClose}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00641}00641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00642}00642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Year\ =\ Year,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00643}00643\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Month\ =\ Month,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00644}00644\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Day\ =\ Day,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00645}00645\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AssetCode\ =\ x.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_priceapp_asset_acb2a7c7f2ddd8fa7c579322de264f035}{assetCode}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00646}00646\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ PairCode\ =\ \textcolor{stringliteral}{"{}AUD"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00647}00647\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Per\ =\ x.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_priceapp_asset_a74613f64ecc58f8cd0d4496e02d6fe30}{spotUnit}}?.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_priceapp_asset_1_1_spotunit_a362ee02b811e851f1a58a49e5d4fac46}{unitName}}\ ??\ \textcolor{stringliteral}{"{}"{}}\ ,}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00648}00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Buy\ =\ x.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_priceapp_asset_a4bc64e34a3e1a3037fe6c618bef375f9}{environmentBuy}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00649}00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Spot\ =\ x.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_priceapp_asset_a6843f4b4444d004a9e86462e1615a481}{environmentSpot}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00650}00650\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Sell\ =\ x.environmentSell}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00651}00651\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00652}00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dailyCloses.Add(dc);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00653}00653\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00654}00654\ \ \ \ \ \ \ \ \ \ \ \ \ \_context.\mbox{\hyperlink{class_task_a_p_i_1_1_contexts_1_1_priceapp_context_a0a63b303899246b496a42f08da57bd43}{DailyCloses}}.AddRange(dailyCloses);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00655}00655\ \ \ \ \ \ \ \ \ \ \ \ \ \_context.SaveChanges();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00656}00656\ \ \ \ \ \ \ \ \ \ \ \ \ var\ exportResult\ =\ ExportChartData();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00657}00657\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (exportResult.Error,\ \textcolor{keyword}{new}\ \{\ SaveDailtySpot\ =\ dailyCloses,\ ExportChartData\ =\ exportResult.Result\ \});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00658}00658\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00659}00659\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (Exception\ ex)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00660}00660\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00661}00661\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}exception\ saving\ daily\ spot"{}},\ ex.ToString());}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00662}00662\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{true},\ ex.ToString());}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00663}00663\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00664}00664\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00665}00665\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00669}00669\ \ \ \ \ \textcolor{keyword}{private}\ (\textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a1d8458171af3cac5a7fc1fc1f35de115}{Error}},\ \textcolor{keywordtype}{object}?\ Result)\ ExportChartData()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00670}00670\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00671}00671\ \ \ \ \ \ \ \ \ \textcolor{comment}{//used\ for\ name\ mapping\ but\ also\ used\ for\ ordering\ results}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00672}00672\ \ \ \ \ \ \ \ \ Dictionary<string,\ string>\ assetCodeToNameMap\ =\ \textcolor{keyword}{new}\ Dictionary<string,\ string>}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00673}00673\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00674}00674\ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{stringliteral}{"{}XAU"{}}]\ =\ \textcolor{stringliteral}{"{}gold"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00675}00675\ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{stringliteral}{"{}XAG"{}}]\ =\ \textcolor{stringliteral}{"{}silver"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00676}00676\ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{stringliteral}{"{}XPT"{}}]\ =\ \textcolor{stringliteral}{"{}platinum"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00677}00677\ \ \ \ \ \ \ \ \ \ \ \ \ [\textcolor{stringliteral}{"{}AUD"{}}]\ =\ \textcolor{stringliteral}{"{}AUD"{}}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00678}00678\ \ \ \ \ \ \ \ \ \};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00679}00679\ \ \ \ \ \ \ \ \ \textcolor{comment}{//use\ iapiservice\ to\ get\ chart\ data,\ order\ it\ by\ timestamp}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00680}00680\ \ \ \ \ \ \ \ \ var\ dailyCloseChartData\ =\ \_iapiService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_internal_a_p_i_service_a79988bdd459de2ee2b545fa7cac3d92a}{DailyCloseChartData}}().OrderBy(ci\ =>\ ci.Timestamp).ToList();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00681}00681\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (dailyCloseChartData\ ==\ \textcolor{keyword}{null}\ ||\ dailyCloseChartData.Count()\ <\ 1)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00682}00682\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00683}00683\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}could\ not\ export\ chart\ data,\ response\ from\ internal\ api\ service\ was\ null\ or\ empty"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00684}00684\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{true},\ \textcolor{stringliteral}{"{}chart\ data\ was\ null\ from\ internal\ api\ service"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00685}00685\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00686}00686\ \ \ \ \ \ \ \ \ \textcolor{comment}{//group\ by\ metal,\ order\ by\ assetcodetonamemap\ dictionary\ elements,\ flatten\ the\ igrouping}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00687}00687\ \ \ \ \ \ \ \ \ var\ dailyCloseChartDataSorted\ =\ dailyCloseChartData}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00688}00688\ \ \ \ \ \ \ \ \ \ \ \ \ .GroupBy(ci\ =>\ \textcolor{keyword}{new}\ \{\ metal\ =\ ci.Metal,\ order\ =\ assetCodeToNameMap.ToList().IndexOf(assetCodeToNameMap.First(map\ =>\ map.Key\ ==\ ci.Metal))\ \})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00689}00689\ \ \ \ \ \ \ \ \ \ \ \ \ .OrderBy(grp\ =>\ grp.Key.order)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00690}00690\ \ \ \ \ \ \ \ \ \ \ \ \ .SelectMany(grp\ =>\ grp);}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00691}00691\ \ \ \ \ \ \ \ \ \textcolor{comment}{//select\ new\ list\ for\ AUD\ currency\ convert\ and\ asset\ code\ to\ name\ map\ at\ same\ time}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00692}00692\ \ \ \ \ \ \ \ \ var\ dailyCloseChartDataAUD\ =\ dailyCloseChartDataSorted.ToList().Select(ci\ =>\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item}{DailyCloseChartItem}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00693}00693\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00694}00694\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Currency\ =\ \textcolor{stringliteral}{"{}AUD"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00695}00695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Metal\ =\ assetCodeToNameMap[ci.Metal],}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00696}00696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Spot\ =\ decimal.Round(ConvertChartDataCurrency(\textcolor{stringliteral}{"{}AUD"{}},\ ci,\ dailyCloseChartData),\ 4),}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00697}00697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Timestamp\ =\ ci.Timestamp}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00698}00698\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00699}00699\ \ \ \ \ \ \ \ \ \textcolor{comment}{//select\ new\ list\ for\ USD\ currency\ convert\ and\ asset\ code\ to\ name\ map\ at\ same\ time}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00700}00700\ \ \ \ \ \ \ \ \ var\ dailyCloseChartDataUSD\ =\ dailyCloseChartDataSorted.ToList().Select(ci\ =>\ \textcolor{keyword}{new}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item}{DailyCloseChartItem}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00701}00701\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00702}00702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Currency\ =\ \textcolor{stringliteral}{"{}USD"{}},}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00703}00703\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Metal\ =\ assetCodeToNameMap[ci.Metal],}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00704}00704\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Spot\ =\ decimal.Round(ConvertChartDataCurrency(\textcolor{stringliteral}{"{}USD"{}},\ ci,\ dailyCloseChartData),\ 4),}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00705}00705\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Timestamp\ =\ ci.Timestamp}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00706}00706\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00707}00707\ \ \ \ \ \ \ \ \ \textcolor{comment}{//save\ files}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00708}00708\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00709}00709\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00710}00710\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!Directory.Exists(\_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_a5d429b089bd15c7c16f03c8e677f3c64}{PriceappSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_priceappsettings_a867349af7d125c704bd2513a3f3a9e70}{ChartDataExportPath}}))}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00711}00711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Directory.CreateDirectory(\_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_a5d429b089bd15c7c16f03c8e677f3c64}{PriceappSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_priceappsettings_a867349af7d125c704bd2513a3f3a9e70}{ChartDataExportPath}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00712}00712\ \ \ \ \ \ \ \ \ \ \ \ \ File.WriteAllText(\$\textcolor{stringliteral}{"{}\{\_settings.PriceappSettings.ChartDataExportPath\}ChartData\_AUD.json"{}},\ JsonConvert.SerializeObject(dailyCloseChartDataAUD,\ Formatting.None));}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00713}00713\ \ \ \ \ \ \ \ \ \ \ \ \ File.WriteAllText(\$\textcolor{stringliteral}{"{}\{\_settings.PriceappSettings.ChartDataExportPath\}ChartData\_USD.json"{}},\ JsonConvert.SerializeObject(dailyCloseChartDataUSD,\ Formatting.None));}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00714}00714\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a6be037b34888bbcf6b47dca8eef472de}{LogDebug}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}chart\ data\ exported"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00715}00715\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{false},\ \$\textcolor{stringliteral}{"{}chart\ data\ exported"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00716}00716\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00717}00717\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (Exception\ ex)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00718}00718\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00719}00719\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a46dc9bf58bc9605c7e17dfee38b94354}{LogError}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.SpotHelper,\ \textcolor{stringliteral}{"{}exception\ exporting\ chart\ data"{}},\ ex.ToString());}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00720}00720\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keyword}{true},\ \$\textcolor{stringliteral}{"{}exception\ saving\ daily\ spot:\ \{ex.ToString()\}"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00721}00721\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00722}00722\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00723}00723\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00727}00727\ \ \ \ \ \textcolor{keyword}{private}\ decimal\ ConvertChartDataCurrency(\textcolor{keywordtype}{string}\ convertTo,\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item}{DailyCloseChartItem}}\ convertItem,\ List<DailyCloseChartItem>\ metalPrices)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00728}00728\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00729}00729\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (convertTo.ToLower()\ ==\ convertItem.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item_ab2620dd19ff6e6f1513f9a1fbbfe58ee}{Currency}}.ToLower()\ ||\ convertItem.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item_a5be5b645aa46c882e0e412c018c19689}{Metal}}.ToLower()\ ==\ \textcolor{stringliteral}{"{}aud"{}})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00730}00730\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ convertItem.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item_af18cc37b4117018e2737b4d4227666a6}{Spot}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00731}00731\ \ \ \ \ \ \ \ \ var\ audUsd\ =\ metalPrices.FirstOrDefault(mp\ =>\ mp.Timestamp\ ==\ convertItem.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item_a4a91da49271c810a5bf525182543b08b}{Timestamp}}\ \&\&\ mp.Metal.ToLower()\ ==\ \textcolor{stringliteral}{"{}aud"{}})?.Spot;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00732}00732\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (audUsd\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00733}00733\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00734}00734\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//find\ closest\ with\ later\ date\ as\ preference}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00735}00735\ \ \ \ \ \ \ \ \ \ \ \ \ audUsd\ =\ metalPrices.Where(mp\ =>\ mp.Metal.ToLower()\ ==\ \textcolor{stringliteral}{"{}aud"{}}\ \&\&\ mp.Timestamp\ >\ convertItem.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item_a4a91da49271c810a5bf525182543b08b}{Timestamp}})?.OrderBy(mp\ =>\ mp.Timestamp).FirstOrDefault()?.Spot;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00736}00736\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (audUsd\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00737}00737\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00738}00738\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//find\ closest\ with\ earlier\ date}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00739}00739\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ audUsd\ =\ metalPrices.Where(mp\ =>\ mp.Metal.ToLower()\ ==\ \textcolor{stringliteral}{"{}aud"{}}\ \&\&\ mp.Timestamp\ <\ convertItem.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item_a4a91da49271c810a5bf525182543b08b}{Timestamp}})?.OrderByDescending(mp\ =>\ mp.Timestamp).FirstOrDefault()?.Spot;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00740}00740\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00741}00741\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00742}00742\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (audUsd\ !=\ \textcolor{keyword}{null})}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00743}00743\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00744}00744\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (convertTo.ToLower())}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00745}00745\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00746}00746\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ \textcolor{stringliteral}{"{}aud"{}}:}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00747}00747\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ convertItem.Spot\ /\ (decimal)audUsd;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00748}00748\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00749}00749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ convertItem.Spot\ *\ (decimal)audUsd;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00750}00750\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00751}00751\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00752}00752\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ convertItem.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_internal_a_p_i_1_1_daily_close_chart_item_af18cc37b4117018e2737b4d4227666a6}{Spot}};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00753}00753\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00754}00754\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00759}\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a89a665897ed47f9b7065ce771100b83c}{00759}}\ \ \ \ \ \textcolor{keyword}{public}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_spot_helper_a89a665897ed47f9b7065ce771100b83c}{CanSync}}()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00760}00760\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00761}00761\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (marketStatusOverride\ ==\ MarketStatusOverrides.ForceClosed)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00762}00762\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00763}00763\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (marketStatusOverride\ ==\ MarketStatusOverrides.ForceOpen)\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00764}00764\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00765}00765\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ marketOpen;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00766}00766\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00767}00767\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00771}00771\ \ \ \ \ \textcolor{keyword}{private}\ \textcolor{keywordtype}{bool}\ IsMarketOpen()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00772}00772\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00773}00773\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_oanda_1_1_instrument_price}{InstrumentPrice}}?\ oandaXAUUSD\ =\ \_iapiService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_internal_a_p_i_service_aa614614518048e1244ae357de18425df}{GetOandaInstrumentPriceUSD}}(\textcolor{stringliteral}{"{}XAU"{}});}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00774}00774\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ oandaXAUUSD?.\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_oanda_1_1_instrument_price_a107de5614f0f7dddc66c2aaa583d9b78}{prices}}?[0].\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_oanda_1_1_instrument_price_1_1_price_a023b866f0cbd286e306e9441910da314}{tradeable}}\ ??\ \textcolor{keyword}{false};}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00775}00775\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00776}00776\ }
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00780}00780\ \ \ \ \ \textcolor{keyword}{private}\ MarketStatusOverrides\ MarketStatusOverride()}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00781}00781\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00782}00782\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}?\ statusOverrideResponse\ =\ \_iapiService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_internal_a_p_i_service_a55b9f5404586ba97531f1cdc013ecaed}{GetPriceappMarketStatusOverride}}();}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00783}00783\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (statusOverrideResponse.HasValue)}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00784}00784\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00785}00785\ \ \ \ \ \ \ \ \ \ \ \ \ MarketStatusOverrides\ statusOverride\ =\ (MarketStatusOverrides)statusOverrideResponse;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00786}00786\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ statusOverride;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00787}00787\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00788}00788\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ MarketStatusOverrides.UseMarket;}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00789}00789\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_spot_helper_8cs_source_l00790}00790\ \}}

\end{DoxyCode}
