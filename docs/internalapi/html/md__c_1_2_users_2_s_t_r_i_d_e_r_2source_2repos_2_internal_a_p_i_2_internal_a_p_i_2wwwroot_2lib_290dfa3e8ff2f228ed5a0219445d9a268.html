<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>InternalAPI: qs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">InternalAPI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">qs</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md4330"></a> A querystring parsing and stringifying library with some added security.</p>
<p><a href="http://travis-ci.org/hapijs/qs"><img src="https://secure.travis-ci.org/hapijs/qs.svg" alt="Build Status" style="pointer-events: none;" class="inline"/></a></p>
<p>Lead Maintainer: <a href="https://github.com/nlf">Nathan LaFreniere</a></p>
<p>The <b>qs</b> module was originally created and maintained by <a href="https://github.com/visionmedia/node-querystring">TJ Holowaychuk</a>.</p>
<h1><a class="anchor" id="autotoc_md4331"></a>
Usage</h1>
<div class="fragment"><div class="line">var Qs = require(&#39;qs&#39;);</div>
<div class="line"> </div>
<div class="line">var obj = Qs.parse(&#39;a=c&#39;);    // { a: &#39;c&#39; }</div>
<div class="line">var str = Qs.stringify(obj);  // &#39;a=c&#39;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4332"></a>
Parsing Objects</h2>
<div class="fragment"><div class="line">Qs.parse(string, [options]);</div>
</div><!-- fragment --><p><b>qs</b> allows you to create nested objects within your query strings, by surrounding the name of sub-keys with square brackets <code>[]</code>. For example, the string &lsquo;'foo[bar]=baz&rsquo;` converts to:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  foo: {</div>
<div class="line">    bar: &#39;baz&#39;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>When using the <code>plainObjects</code> option the parsed value is returned as a plain object, created via <code>Object.create(null)</code> and as such you should be aware that prototype methods will not exist on it and a user may set those names to whatever value they like:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a.hasOwnProperty=b&#39;, { plainObjects: true });</div>
<div class="line">// { a: { hasOwnProperty: &#39;b&#39; } }</div>
</div><!-- fragment --><p>By default parameters that would overwrite properties on the object prototype are ignored, if you wish to keep the data from those fields either use <code>plainObjects</code> as mentioned above, or set <code>allowPrototypes</code> to <code>true</code> which will allow user input to overwrite those properties. <em>WARNING</em> It is generally a bad idea to enable this option as it can cause problems when attempting to use the properties that have been overwritten. Always be careful with this option.</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a.hasOwnProperty=b&#39;, { allowPrototypes: true });</div>
<div class="line">// { a: { hasOwnProperty: &#39;b&#39; } }</div>
</div><!-- fragment --><p>URI encoded strings work too:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a%5Bb%5D=c&#39;);</div>
<div class="line">// { a: { b: &#39;c&#39; } }</div>
</div><!-- fragment --><p>You can also nest your objects, like &lsquo;'foo[bar][baz]=foobarbaz&rsquo;`:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  foo: {</div>
<div class="line">    bar: {</div>
<div class="line">      baz: &#39;foobarbaz&#39;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>By default, when nesting objects <b>qs</b> will only parse up to 5 children deep. This means if you attempt to parse a string like &lsquo;'a[b][c][d][e][f][g][h][i]=j&rsquo;` your resulting object will be:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  a: {</div>
<div class="line">    b: {</div>
<div class="line">      c: {</div>
<div class="line">        d: {</div>
<div class="line">          e: {</div>
<div class="line">            f: {</div>
<div class="line">              &#39;[g][h][i]&#39;: &#39;j&#39;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>This depth can be overridden by passing a <code>depth</code> option to <code>Qs.parse(string, [options])</code>:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[b][c][d][e][f][g][h][i]=j&#39;, { depth: 1 });</div>
<div class="line">// { a: { b: { &#39;[c][d][e][f][g][h][i]&#39;: &#39;j&#39; } } }</div>
</div><!-- fragment --><p>The depth limit helps mitigate abuse when <b>qs</b> is used to parse user input, and it is recommended to keep it a reasonably small number.</p>
<p>For similar reasons, by default <b>qs</b> will only parse up to 1000 parameters. This can be overridden by passing a <code>parameterLimit</code> option:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a=b&amp;c=d&#39;, { parameterLimit: 1 });</div>
<div class="line">// { a: &#39;b&#39; }</div>
</div><!-- fragment --><p>An optional delimiter can also be passed:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a=b;c=d&#39;, { delimiter: &#39;;&#39; });</div>
<div class="line">// { a: &#39;b&#39;, c: &#39;d&#39; }</div>
</div><!-- fragment --><p>Delimiters can be a regular expression too:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a=b;c=d,e=f&#39;, { delimiter: /[;,]/ });</div>
<div class="line">// { a: &#39;b&#39;, c: &#39;d&#39;, e: &#39;f&#39; }</div>
</div><!-- fragment --><p>Option <code>allowDots</code> can be used to enable dot notation:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a.b=c&#39;, { allowDots: true });</div>
<div class="line">// { a: { b: &#39;c&#39; } }</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4333"></a>
Parsing Arrays</h2>
<p><b>qs</b> can also parse arrays using a similar <code>[]</code> notation:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[]=b&amp;a[]=c&#39;);</div>
<div class="line">// { a: [&#39;b&#39;, &#39;c&#39;] }</div>
</div><!-- fragment --><p>You may specify an index as well:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[1]=c&amp;a[0]=b&#39;);</div>
<div class="line">// { a: [&#39;b&#39;, &#39;c&#39;] }</div>
</div><!-- fragment --><p>Note that the only difference between an index in an array and a key in an object is that the value between the brackets must be a number to create an array. When creating arrays with specific indices, <b>qs</b> will compact a sparse array to only the existing values preserving their order:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[1]=b&amp;a[15]=c&#39;);</div>
<div class="line">// { a: [&#39;b&#39;, &#39;c&#39;] }</div>
</div><!-- fragment --><p>Note that an empty string is also a value, and will be preserved:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[]=&amp;a[]=b&#39;);</div>
<div class="line">// { a: [&#39;&#39;, &#39;b&#39;] }</div>
<div class="line">Qs.parse(&#39;a[0]=b&amp;a[1]=&amp;a[2]=c&#39;);</div>
<div class="line">// { a: [&#39;b&#39;, &#39;&#39;, &#39;c&#39;] }</div>
</div><!-- fragment --><p><b>qs</b> will also limit specifying indices in an array to a maximum index of <code>20</code>. Any array members with an index of greater than <code>20</code> will instead be converted to an object with the index as the key:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[100]=b&#39;);</div>
<div class="line">// { a: { &#39;100&#39;: &#39;b&#39; } }</div>
</div><!-- fragment --><p>This limit can be overridden by passing an <code>arrayLimit</code> option:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[1]=b&#39;, { arrayLimit: 0 });</div>
<div class="line">// { a: { &#39;1&#39;: &#39;b&#39; } }</div>
</div><!-- fragment --><p>To disable array parsing entirely, set <code>parseArrays</code> to <code>false</code>.</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[]=b&#39;, { parseArrays: false });</div>
<div class="line">// { a: { &#39;0&#39;: &#39;b&#39; } }</div>
</div><!-- fragment --><p>If you mix notations, <b>qs</b> will merge the two items into an object:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[0]=b&amp;a[b]=c&#39;);</div>
<div class="line">// { a: { &#39;0&#39;: &#39;b&#39;, b: &#39;c&#39; } }</div>
</div><!-- fragment --><p>You can also create arrays of objects:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a[][b]=c&#39;);</div>
<div class="line">// { a: [{ b: &#39;c&#39; }] }</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4334"></a>
Stringifying</h2>
<div class="fragment"><div class="line">Qs.stringify(object, [options]);</div>
</div><!-- fragment --><p>When stringifying, <b>qs</b> by default URI encodes output. Objects are stringified as you would expect:</p>
<div class="fragment"><div class="line">Qs.stringify({ a: &#39;b&#39; });</div>
<div class="line">// &#39;a=b&#39;</div>
<div class="line">Qs.stringify({ a: { b: &#39;c&#39; } });</div>
<div class="line">// &#39;a%5Bb%5D=c&#39;</div>
</div><!-- fragment --><p>This encoding can be disabled by setting the <code>encode</code> option to <code>false</code>:</p>
<div class="fragment"><div class="line">Qs.stringify({ a: { b: &#39;c&#39; } }, { encode: false });</div>
<div class="line">// &#39;a[b]=c&#39;</div>
</div><!-- fragment --><p>Examples beyond this point will be shown as though the output is not URI encoded for clarity. Please note that the return values in these cases <em>will</em> be URI encoded during real usage.</p>
<p>When arrays are stringified, by default they are given explicit indices:</p>
<div class="fragment"><div class="line">Qs.stringify({ a: [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;] });</div>
<div class="line">// &#39;a[0]=b&amp;a[1]=c&amp;a[2]=d&#39;</div>
</div><!-- fragment --><p>You may override this by setting the <code>indices</code> option to <code>false</code>:</p>
<div class="fragment"><div class="line">Qs.stringify({ a: [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;] }, { indices: false });</div>
<div class="line">// &#39;a=b&amp;a=c&amp;a=d&#39;</div>
</div><!-- fragment --><p>You may use the <code>arrayFormat</code> option to specify the format of the output array</p>
<div class="fragment"><div class="line">Qs.stringify({ a: [&#39;b&#39;, &#39;c&#39;] }, { arrayFormat: &#39;indices&#39; })</div>
<div class="line">// &#39;a[0]=b&amp;a[1]=c&#39;</div>
<div class="line">Qs.stringify({ a: [&#39;b&#39;, &#39;c&#39;] }, { arrayFormat: &#39;brackets&#39; })</div>
<div class="line">// &#39;a[]=b&amp;a[]=c&#39;</div>
<div class="line">Qs.stringify({ a: [&#39;b&#39;, &#39;c&#39;] }, { arrayFormat: &#39;repeat&#39; })</div>
<div class="line">// &#39;a=b&amp;a=c&#39;</div>
</div><!-- fragment --><p>Empty strings and null values will omit the value, but the equals sign (=) remains in place:</p>
<div class="fragment"><div class="line">Qs.stringify({ a: &#39;&#39; });</div>
<div class="line">// &#39;a=&#39;</div>
</div><!-- fragment --><p>Properties that are set to <code>undefined</code> will be omitted entirely:</p>
<div class="fragment"><div class="line">Qs.stringify({ a: null, b: undefined });</div>
<div class="line">// &#39;a=&#39;</div>
</div><!-- fragment --><p>The delimiter may be overridden with stringify as well:</p>
<div class="fragment"><div class="line">Qs.stringify({ a: &#39;b&#39;, c: &#39;d&#39; }, { delimiter: &#39;;&#39; });</div>
<div class="line">// &#39;a=b;c=d&#39;</div>
</div><!-- fragment --><p>Finally, you can use the <code>filter</code> option to restrict which keys will be included in the stringified output. If you pass a function, it will be called for each key to obtain the replacement value. Otherwise, if you pass an array, it will be used to select properties and array indices for stringification:</p>
<div class="fragment"><div class="line">function filterFunc(prefix, value) {</div>
<div class="line">  if (prefix == &#39;b&#39;) {</div>
<div class="line">    // Return an `undefined` value to omit a property.</div>
<div class="line">    return;</div>
<div class="line">  }</div>
<div class="line">  if (prefix == &#39;e[f]&#39;) {</div>
<div class="line">    return value.getTime();</div>
<div class="line">  }</div>
<div class="line">  if (prefix == &#39;e[g][0]&#39;) {</div>
<div class="line">    return value * 2;</div>
<div class="line">  }</div>
<div class="line">  return value;</div>
<div class="line">}</div>
<div class="line">Qs.stringify({ a: &#39;b&#39;, c: &#39;d&#39;, e: { f: new Date(123), g: [2] } }, { filter: filterFunc })</div>
<div class="line">// &#39;a=b&amp;c=d&amp;e[f]=123&amp;e[g][0]=4&#39;</div>
<div class="line">Qs.stringify({ a: &#39;b&#39;, c: &#39;d&#39;, e: &#39;f&#39; }, { filter: [&#39;a&#39;, &#39;e&#39;] })</div>
<div class="line">// &#39;a=b&amp;e=f&#39;</div>
<div class="line">Qs.stringify({ a: [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], e: &#39;f&#39; }, { filter: [&#39;a&#39;, 0, 2] })</div>
<div class="line">// &#39;a[0]=b&amp;a[2]=d&#39;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md4335"></a>
Handling of <code>null</code> values</h2>
<p>By default, <code>null</code> values are treated like empty strings:</p>
<div class="fragment"><div class="line">Qs.stringify({ a: null, b: &#39;&#39; });</div>
<div class="line">// &#39;a=&amp;b=&#39;</div>
</div><!-- fragment --><p>Parsing does not distinguish between parameters with and without equal signs. Both are converted to empty strings.</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a&amp;b=&#39;)</div>
<div class="line">// { a: &#39;&#39;, b: &#39;&#39; }</div>
</div><!-- fragment --><p>To distinguish between <code>null</code> values and empty strings use the <code>strictNullHandling</code> flag. In the result string the <code>null</code> values have no <code>=</code> sign:</p>
<div class="fragment"><div class="line">Qs.stringify({ a: null, b: &#39;&#39; }, { strictNullHandling: true });</div>
<div class="line">// &#39;a&amp;b=&#39;</div>
</div><!-- fragment --><p>To parse values without <code>=</code> back to <code>null</code> use the <code>strictNullHandling</code> flag:</p>
<div class="fragment"><div class="line">Qs.parse(&#39;a&amp;b=&#39;, { strictNullHandling: true });</div>
<div class="line">// { a: null, b: &#39;&#39; }</div>
</div><!-- fragment --><p>To completely skip rendering keys with <code>null</code> values, use the <code>skipNulls</code> flag:</p>
<div class="fragment"><div class="line">qs.stringify({ a: &#39;b&#39;, c: null}, { skipNulls: true })</div>
<div class="line">// &#39;a=b&#39;</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
