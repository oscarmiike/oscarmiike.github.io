\doxysection{Internal\+API.\+Controllers.\+Oanda\+Controller Class Reference}
\hypertarget{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller}{}\label{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller}\index{InternalAPI.Controllers.OandaController@{InternalAPI.Controllers.OandaController}}


Inheritance diagram for Internal\+API.\+Controllers.\+Oanda\+Controller\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Internal\+API.\+Controllers.\+Oanda\+Controller\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller_a59b1f994d8f181ce5381062d86768e3e}{Oanda\+Controller}} (ILogger$<$ \mbox{\hyperlink{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller}{Oanda\+Controller}} $>$ logger, IOptions$<$ \mbox{\hyperlink{class_internal_a_p_i_1_1_settings_1_1_oanda_settings}{Oanda\+Settings}} $>$ oanda\+Settings)
\item 
async Task$<$ object $>$ \mbox{\hyperlink{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller_ac9bac0d0544130b4986e0d11e5393780}{Pass\+Through}} (\mbox{[}From\+Route\mbox{]} string ainslie\+Company, \mbox{[}From\+Route\mbox{]} string url)
\begin{DoxyCompactList}\small\item\em Finds Oanda credentials, decorates proxy request and sends to Oanda. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller_a59b1f994d8f181ce5381062d86768e3e}\label{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller_a59b1f994d8f181ce5381062d86768e3e} 
\index{InternalAPI.Controllers.OandaController@{InternalAPI.Controllers.OandaController}!OandaController@{OandaController}}
\index{OandaController@{OandaController}!InternalAPI.Controllers.OandaController@{InternalAPI.Controllers.OandaController}}
\doxysubsubsection{\texorpdfstring{OandaController()}{OandaController()}}
{\footnotesize\ttfamily Internal\+API.\+Controllers.\+Oanda\+Controller.\+Oanda\+Controller (\begin{DoxyParamCaption}\item[{ILogger$<$ \mbox{\hyperlink{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller}{Oanda\+Controller}} $>$}]{logger,  }\item[{IOptions$<$ \mbox{\hyperlink{class_internal_a_p_i_1_1_settings_1_1_oanda_settings}{Oanda\+Settings}} $>$}]{oanda\+Settings }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \ \ \ \ \_logger\ =\ logger;}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \_oandaSettings\ =\ oandaSettings.Value;}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \}}

\end{DoxyCode}


\doxysubsection{Member Function Documentation}
\Hypertarget{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller_ac9bac0d0544130b4986e0d11e5393780}\label{class_internal_a_p_i_1_1_controllers_1_1_oanda_controller_ac9bac0d0544130b4986e0d11e5393780} 
\index{InternalAPI.Controllers.OandaController@{InternalAPI.Controllers.OandaController}!PassThrough@{PassThrough}}
\index{PassThrough@{PassThrough}!InternalAPI.Controllers.OandaController@{InternalAPI.Controllers.OandaController}}
\doxysubsubsection{\texorpdfstring{PassThrough()}{PassThrough()}}
{\footnotesize\ttfamily async Task$<$ object $>$ Internal\+API.\+Controllers.\+Oanda\+Controller.\+Pass\+Through (\begin{DoxyParamCaption}\item[{\mbox{[}\+From\+Route\mbox{]} string}]{ainslie\+Company,  }\item[{\mbox{[}\+From\+Route\mbox{]} string}]{url }\end{DoxyParamCaption})}



Finds Oanda credentials, decorates proxy request and sends to Oanda. 


\begin{DoxyParams}{Parameters}
{\em ainslie\+Company} & \\
\hline
{\em url} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \_logger.LogInformation(\$\textcolor{stringliteral}{"{}Received\ Oanda\ pass\ through\ for\ company\ '\{ainslieCompany\}',\ url\ '\{url\}'."{}});}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Find\ Oanda\ account\ settings}}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ var\ oandaAccountSettings\ =\ \_oandaSettings?.\mbox{\hyperlink{class_internal_a_p_i_1_1_settings_1_1_oanda_settings_a70b5b7badbfb94b7560efd0533314875}{Accounts}}?.FirstOrDefault(a\ =>\ String.Equals(a.CompanyCode,\ ainslieCompany,\ StringComparison.CurrentCultureIgnoreCase));}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (oandaAccountSettings\ ==\ \textcolor{keyword}{null})}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ var\ errorMessage\ =\ \$\textcolor{stringliteral}{"{}Oanda\ endpoint\ not\ configured\ for\ company\ code\ '\{ainslieCompany\}'"{}};}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_logger.LogError(errorMessage);}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ NotFound(\$\textcolor{stringliteral}{"{}Internal\ API:\ \{errorMessage\}"{}});}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Create\ client\ and\ add\ Oanda\ required\ headers}}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \ \ \ \ var\ httpClient\ =\ \textcolor{keyword}{new}\ HttpClient(\textcolor{keyword}{new}\ HttpClientHandler()}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ AllowAutoRedirect\ =\ \textcolor{keyword}{false}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ \ \ \ \ \});}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \ \ \ \ httpClient.DefaultRequestHeaders.Authorization\ =}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ AuthenticationHeaderValue(\textcolor{stringliteral}{"{}Bearer"{}},\ oandaAccountSettings.Token);}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \ \ \ \ httpClient.DefaultRequestHeaders.Add(\textcolor{stringliteral}{"{}Accept-\/Datetime-\/Format"{}},\ \textcolor{stringliteral}{"{}RFC3339"{}});}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \ \ \ \ var\ requestUrl\ =\ \$\textcolor{stringliteral}{"{}accounts/\{oandaAccountSettings.AccountId\}/\{url\}\{(Request.QueryString.HasValue\ ?\ Request.QueryString.Value\ :\ string.Empty)\}"{}};}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Proxy\ request\ /\ response}}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ var\ request\ =\ HttpContext.CreateProxyHttpRequest(\textcolor{keyword}{new}\ Uri(\$\textcolor{stringliteral}{"{}\{\_oandaSettings.Endpoint\}/\{requestUrl\}"{}}));}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ var\ response\ =\ await\ httpClient.SendAsync(request,\ HttpCompletionOption.ResponseHeadersRead,\ HttpContext.RequestAborted);}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ await\ HttpContext.CopyProxyHttpResponse(response);}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \}}

\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
C\+:/\+Users/\+STRIDER/source/repos/\+Internal\+API/\+Internal\+API/\+Controllers/\mbox{\hyperlink{_oanda_controller_8cs}{Oanda\+Controller.\+cs}}\end{DoxyCompactItemize}
