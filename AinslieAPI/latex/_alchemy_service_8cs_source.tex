\doxysection{Alchemy\+Service.\+cs}
\hypertarget{_alchemy_service_8cs_source}{}\label{_alchemy_service_8cs_source}\index{C:/Users/STRIDER/source/repos/TaskAPI/Services/AlchemyService.cs@{C:/Users/STRIDER/source/repos/TaskAPI/Services/AlchemyService.cs}}
\mbox{\hyperlink{_alchemy_service_8cs}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00001}00001\ \textcolor{keyword}{using\ }Microsoft.Extensions.Options;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00002}00002\ \textcolor{keyword}{using\ }Nethereum.Model;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00003}00003\ \textcolor{keyword}{using\ }Nethereum.Web3;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00004}00004\ \textcolor{keyword}{using\ }Newtonsoft.Json;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00005}00005\ \textcolor{keyword}{using\ }System.Net;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00006}00006\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_contexts}{TaskAPI.Contexts}};}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00007}00007\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_helpers_1_1_settings}{TaskAPI.Helpers.Settings}};}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00008}00008\ \textcolor{keyword}{using\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_models_1_1_d_t_o_1_1_polygon_oracle}{TaskAPI.Models.DTO.PolygonOracle}};}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00009}00009\ }
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00010}\mbox{\hyperlink{namespace_task_a_p_i_1_1_services}{00010}}\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespace_task_a_p_i_1_1_services}{TaskAPI.Services}};}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00011}00011\ }
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00012}\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_alchemy_service}{00012}}\ \textcolor{keyword}{public}\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_alchemy_service}{AlchemyService}}}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00013}00013\ \{}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00014}00014\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}\ \_logService;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00015}00015\ \ \ \ \ \textcolor{keyword}{private}\ \mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings}{TaskAPISettings}}\ \_settings;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00016}00016\ }
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00017}\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_alchemy_service_a39b3842e6a2a143f5450f9eda643e0b0}{00017}}\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_alchemy_service_a39b3842e6a2a143f5450f9eda643e0b0}{AlchemyService}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}\ logService,\ IOptions<TaskAPISettings>\ taskAPISettings)}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00018}00018\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00019}00019\ \ \ \ \ \ \ \ \ \_logService\ =\ logService;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00020}00020\ \ \ \ \ \ \ \ \ \_settings\ =\ taskAPISettings.Value;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00021}00021\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00023}\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_alchemy_service_a8db06c3be654656ef61b3177a0624787}{00023}}\ \ \ \ \ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_polygon_oracle_1_1_latest_round_data_response}{LatestRoundDataResponse}}?\ \mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_alchemy_service_a8db06c3be654656ef61b3177a0624787}{LatestRoundData}}(\textcolor{keywordtype}{string}\ contractAddress)}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00024}00024\ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00025}00025\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_polygon_oracle_1_1_latest_round_data_response}{LatestRoundDataResponse}}\ latestRoundResponse\ =\ \textcolor{keyword}{null};}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00026}00026\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00027}00027\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00028}00028\ \ \ \ \ \ \ \ \ \ \ \ \ var\ NWeb\ =\ \textcolor{keyword}{new}\ Web3(\$\textcolor{stringliteral}{"{}\{\_settings.AlchemySettings.Web3Endpoint\}\{\_settings.AlchemySettings.APIKey\}"{}});}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00029}00029\ \ \ \ \ \ \ \ \ \ \ \ \ var\ abi\ =\ JsonConvert.SerializeObject(\_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a119acadd0ece87c491c7a0f227a421aa}{LatestRoundDataABI}});}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00030}00030\ \ \ \ \ \ \ \ \ \ \ \ \ var\ Ct\ =\ NWeb.Eth.GetContract(abi,\ contractAddress);}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00031}00031\ \ \ \ \ \ \ \ \ \ \ \ \ var\ Fn\ =\ Ct.GetFunction(\_settings.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_ac56f44c706202b85f9a949eefd802a4b}{PolygonOracleSettings}}.\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_a119acadd0ece87c491c7a0f227a421aa}{LatestRoundDataABI}}[0].\mbox{\hyperlink{class_task_a_p_i_1_1_helpers_1_1_settings_1_1_task_a_p_i_settings_1_1_polygonoraclesettings_1_1_a_b_i_a46802c8f262ff386414a7ce5298d747e}{name}});}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00032}00032\ \ \ \ \ \ \ \ \ \ \ \ \ latestRoundResponse\ =\ Fn.CallDeserializingToObjectAsync<\mbox{\hyperlink{class_task_a_p_i_1_1_models_1_1_d_t_o_1_1_polygon_oracle_1_1_latest_round_data_response}{LatestRoundDataResponse}}>().Result;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00033}00033\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00034}00034\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{catch}\ (Exception\ ex)}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00035}00035\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00036}00036\ \ \ \ \ \ \ \ \ \ \ \ \ \_logService.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_a78c9df658858fa3099eed69421423898}{LogException}}(\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service}{LogService}}.\mbox{\hyperlink{class_task_a_p_i_1_1_services_1_1_log_service_ac2b08e94307168cb702773d148d166ba}{LogSources}}.AlchemyService,\ \textcolor{stringliteral}{"{}Exception\ getting\ latestRoundData"{}},\ contractAddress,\ ex);}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00037}00037\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00038}00038\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ latestRoundResponse;}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00039}00039\ \ \ \ \ \}}
\DoxyCodeLine{\Hypertarget{_alchemy_service_8cs_source_l00040}00040\ \}}

\end{DoxyCode}
