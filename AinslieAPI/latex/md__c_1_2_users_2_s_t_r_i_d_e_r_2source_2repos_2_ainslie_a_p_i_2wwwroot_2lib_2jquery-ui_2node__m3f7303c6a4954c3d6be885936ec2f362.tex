\chapter{write-\/file-\/atomic}
\hypertarget{md__c_1_2_users_2_s_t_r_i_d_e_r_2source_2repos_2_ainslie_a_p_i_2wwwroot_2lib_2jquery-ui_2node__m3f7303c6a4954c3d6be885936ec2f362}{}\label{md__c_1_2_users_2_s_t_r_i_d_e_r_2source_2repos_2_ainslie_a_p_i_2wwwroot_2lib_2jquery-ui_2node__m3f7303c6a4954c3d6be885936ec2f362}\index{write-\/file-\/atomic@{write-\/file-\/atomic}}
This is an extension for node\textquotesingle{}s {\ttfamily fs.\+write\+File} that makes its operation atomic and allows you set ownership (uid/gid of the file).\hypertarget{md__c_1_2_users_2_s_t_r_i_d_e_r_2source_2repos_2_ainslie_a_p_i_2wwwroot_2lib_2jquery-ui_2node__m3f7303c6a4954c3d6be885936ec2f362_autotoc_md5248}{}\doxysubsection{\texorpdfstring{var write\+File\+Atomic = require(\textquotesingle{}write-\/file-\/atomic\textquotesingle{})~\newline
write\+File\+Atomic(filename, data, \mbox{[}options\mbox{]}, callback)}{var write\+File\+Atomic = require(\textquotesingle{}write-\/file-\/atomic\textquotesingle{})~\newline
write\+File\+Atomic(filename, data, \mbox{[}options\mbox{]}, callback)}}\label{md__c_1_2_users_2_s_t_r_i_d_e_r_2source_2repos_2_ainslie_a_p_i_2wwwroot_2lib_2jquery-ui_2node__m3f7303c6a4954c3d6be885936ec2f362_autotoc_md5248}

\begin{DoxyItemize}
\item filename {\bfseries{String}}
\item data {\bfseries{String}} \texorpdfstring{$\vert$}{|} {\bfseries{Buffer}}
\item options {\bfseries{Object}}
\begin{DoxyItemize}
\item chown {\bfseries{Object}}
\begin{DoxyItemize}
\item uid {\bfseries{Number}}
\item gid {\bfseries{Number}}
\end{DoxyItemize}
\item encoding {\bfseries{String}} \texorpdfstring{$\vert$}{|} {\bfseries{Null}} default = \textquotesingle{}utf8\textquotesingle{}
\item mode {\bfseries{Number}} default = 438 (aka 0666 in Octal) callback {\bfseries{Function}}
\end{DoxyItemize}
\end{DoxyItemize}

Atomically and asynchronously writes data to a file, replacing the file if it already exists. data can be a string or a buffer.

The file is initially named {\ttfamily filename + "{}."{} + murmurhex(\+\_\+\+\_\+filename, process.\+pid, ++invocations)}. If write\+File completes successfully then, if passed the {\bfseries{chown}} option it will change the ownership of the file. Finally it renames the file back to the filename you specified. If it encounters errors at any of these steps it will attempt to unlink the temporary file and then pass the error back to the caller.

If provided, the {\bfseries{chown}} option requires both {\bfseries{uid}} and {\bfseries{gid}} properties or else you\textquotesingle{}ll get an error.

The {\bfseries{encoding}} option is ignored if {\bfseries{data}} is a buffer. It defaults to \textquotesingle{}utf8\textquotesingle{}.

Example\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{writeFileAtomic('message.txt',\ 'Hello\ Node',\ \{chown:\{uid:100,gid:50\}\},\ function\ (err)\ \{}
\DoxyCodeLine{\ \ if\ (err)\ throw\ err;}
\DoxyCodeLine{\ \ console.log('It\(\backslash\)'s\ saved!');}
\DoxyCodeLine{\});}

\end{DoxyCode}
\hypertarget{md__c_1_2_users_2_s_t_r_i_d_e_r_2source_2repos_2_ainslie_a_p_i_2wwwroot_2lib_2jquery-ui_2node__m3f7303c6a4954c3d6be885936ec2f362_autotoc_md5249}{}\doxysubsection{\texorpdfstring{var write\+File\+Atomic\+Sync = require(\textquotesingle{}write-\/file-\/atomic\textquotesingle{}).sync~\newline
write\+File\+Atomic\+Sync(filename, data, \mbox{[}options\mbox{]})}{var write\+File\+Atomic\+Sync = require(\textquotesingle{}write-\/file-\/atomic\textquotesingle{}).sync~\newline
write\+File\+Atomic\+Sync(filename, data, \mbox{[}options\mbox{]})}}\label{md__c_1_2_users_2_s_t_r_i_d_e_r_2source_2repos_2_ainslie_a_p_i_2wwwroot_2lib_2jquery-ui_2node__m3f7303c6a4954c3d6be885936ec2f362_autotoc_md5249}
The synchronous version of {\bfseries{write\+File\+Atomic}}. 